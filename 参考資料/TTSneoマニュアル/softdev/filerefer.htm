<html>

<head>
<meta http-equiv="Content-Language" content="ja">
<meta http-equiv="Content-Type" content="text/html; charset=shift_jis">
<link rel="stylesheet" type="text/css" href="../style.css">
<title>分散化 - プログラムを複数のファイルに分ける</title>
</head>

<body>

<div id="header">
	<div class="title">
		１０．分散化 - プログラムを複数に分ける</div>
	<div class="sub">
		TTSneoマニュアル</div>
	<div class="navi">
		<a target="_parent" href="../index.html">マニュアル</a> &gt; <a target="_parent" href="index.htm">ソフト作り編</a> &gt;</div>
	<div class="date">
		<!--webbot bot="Timestamp" s-type="EDITED" s-format="%Y/%m/%d" startspan -->2007/05/12<!--webbot bot="Timestamp" endspan i-checksum="12623" -->更新</div>
</div>
<h2>プログラムが大きくなってきたら</h2>
<table border="0" cellpadding="10" cellspacing="0" width="100%">
	<tr>
		<td><img border="0" src="../img/ttschar10.png" width="119" height="121"></td>
		<td>本格的なソフトを作るようになると、プログラムが膨大になり、手順などを探すのに時間がかかってしまいます。<p>
		TTSneoでは、一つのプログラムを、複数のTTSneoファイルに分けて作成できるように作られています。</p>
		<p>複数のファイルに分けることで、プログラムが分かりやすくなり、整理しやすくなります。</td>
	</tr>
</table>
<hr>
<blockquote>
	<p class="tomo">
	とも　「ミスを探す方法のおかげで、エラーは少なくなったけど、だんだんプログラムがごちゃごちゃしてきて、次の日見たらわけが分からなくなっちゃった・・・」</p>
	<p class="neo">ねお　「あらら。でもソフトを作っているとよくあることだよ。<br>
	今回は、プログラムを複数のファイルに分けて、分かりやすくする方法を紹介するね」</p>
</blockquote>
<p>　</p>
<h2>どうやって分ける？</h2>
<blockquote>
	<p class="neo">ねお　「プログラムを複数のファイルに分ける方法は、いろいろあります。<br>
	プログラムは手順単位でわけることができます。」</p>
	<p class="neo">　</p>
</blockquote>
<h4>１．使うウィンドウごとに分ける</h4>
<blockquote>
	<p>メイン画面・バージョン情報・設定画面と言った画面ごとにTTSneoファイルをわけます。</p>
</blockquote>
<h4>２．機能ごとに分ける</h4>
<blockquote>
	<p>ウィンドウ関係・ファイル関係・インターネット関係・・・　などと、プログラムの目的別に分ける方法です。</p>
	<p class="tomo">　</p>
	<p class="tomo">とも　「どっちの方法がいいかな？」</p>
	<p class="neo">ねお　「１．の方法は、混乱する可能性が少ないので、よく分からない場合は、１．の方法をお勧めです。」</p>
	<p class="tomo">とも　「じゃぁ　そうするね」</p>
	<p class="neo">ねお　「他にも自分の考え方に合う分け方があると思うから、いろいろ試してみましょう。」</p>
	<p>　</p>
	<p>プログラムの分散化を行うと、TTSneoデザイナが強制終了される問題を回避できます。</p>
</blockquote>
<p>　</p>
<h2>「参照」命令を使って分散化</h2>
<blockquote>
	<p class="tomo">とも　「プログラムを、複数のファイルに分けてみたけど、これだけでは実行できないよね。」</p>
	<p class="neo">ねお　「まあ、そうあせらずに　(汗。<br>
	「参照」命令を使えば、他のTTSneoファイルの手順を利用できるようになります。」</p>
	<p>たとえば、２つのウィンドウを使うプログラムを、ウィンドウごとに３つのTTSneoファイルに分散するには、下のようにします。</p>
</blockquote>
<p><b>例</b></p>
<p><b>ソフト1.tts</b>　（実行するときは、このファイルを実行）</p>
<p class="example"><font color="#008000"><b>ーー メインプログラム ーー</b></font><br>
<br>
使うファイルは、「ソフト1-2.tts」<br>
使うファイルは、「ソフト1-3.tts」<br>
<br>
「ソフト1-2.tts」を参照<br>
「ソフト1-3.tts」を参照<br>
<br>
<font color="#008000"><b>ーー参照命令を使うと、そのファイルの手順が使えるようになる。</b></font><br>
ウィンドウ１の表示<br>
待機</p>
<p><b>ソフト1-2.tts</b></p>
<p class="example"><font color="#008000"><b>ーー ウィンドウ１関連 ーー</b></font><br>
<br>
手順は　ウィンドウ１の表示<br>
　　・・・・・・・・・<br>
終わり<br>
<br>
手順は　ウィンドウ１のボタン１をクリック<br>
　　固定ウィンドウ１の表示<br>
終わり</p>
<p><b>ソフト1-3.tts</b></p>
<p class="example"><font color="#008000"><b>ーー</b></font><b><font color="#008000"> 固定ウィンドウ１関連 ーー<br>
</font></b><br>
手順は　固定ウィンドウ１の表示<br>
　　・・・・・・・・・<br>
終わり<br>
<br>
手順は　固定ウィンドウ１のボタン１をクリック<br>
　　・・・・・・・・・<br>
終わり</p>
<blockquote>
	<p class="neo">
	ねお　「例のように、「参照」命令を使って、分割したファイルを指定すると、プログラムを実行するときは一つのファイルになっているときと同じようになります。」</p>
	<p class="tomo">とも　「手順や変数は、そのまま使えるの？」</p>
	<p class="neo">ねお　「うん。手順や変数などは、ファイル関係なくどこからでも利用できます。」</p>
	<p class="tomo">とも　「そっか、だいぶ苦労したけど、複数のファイルにわけたら、手順を探すのも楽だし、見やすくなったよ。ありがとう〜」</p>
	<p class="neo">
	ねお　「どういたしまして。このように、「参照」命令を使って分散化すると、プログラムをまとめることができるので、より効率的にソフトを作ることができます。」</p>
	<p>　</p>
	<p>実行可能形式を作成する場合も、「使うファイルは」命令を使えば、一つのファイルにすることができます。</p>
	<p>※TTSneoファイルを指定した場合、自動的に暗号化を行います。</p>
</blockquote>
<p>　</p>
	<h2>プロジェクトファイルについて(*.tpj)</h2>
	<blockquote>
	<p class="tomo">とも　「次回TTSneoデザイナを使うときに、分散化したファイルを一度に開くことはできるの？」</p>
	<p class="neo">ねお　「プロジェクトファイルというファイルを作成しておくことで、いちいちファイルを一つずつ開く必要はなくなります。」</p>
	<p class="tomo">とも　「プロジェクトファイルを作るは「名前をつけて保存」で作れるんだね」</p>
	<p class="neo">ねお　「そのとおり！　プロジェクトファイルを開くと、プロジェクトファイルを保存した時点で開いていたファイルが一度に開かれます。」</p>
<p>　</p>
</blockquote>
<h2>エラーが起こったときも・・・</h2>
<blockquote>
	<p>プログラムの分散化を行っても、「調査ウィンドウ」は、利用できます。</p>
	<p>また、エラーが発生しても問題のファイル名と行数が表示されます。</p>
</blockquote>
	<p>　</p>
<h2>参照ファイルごとに「ここだけの変数」が指定可能</h2>
<blockquote>
	<p>分散化を行った場合、「ここだけの変数は」命令を使って、参照されたTTSneoファイルでのみ有効な変数を作成することができます。</p>
	<p>この命令で指定した変数は、他のTTSneoファイルなどからは独立します。</p>
	<p>この機能を活用することで、より再利用可能なプログラムを作ることが可能です。</p>
</blockquote>
<p>　</p>
<h2>実行可能ファイルにするときの注意</h2>
<blockquote>
	<p>「参照」命令で指定したファイルは、実行可能ファイル(EXE)を作成した際は添付されません。<br>
	分散化したプログラムを実行可能ファイルにする際は、「使うファイルは」命令を使ってTTSneoファイルを指定してください。</p>
	<p>また、この際に指定したTTSneoファイルは自動的に暗号化されます。</p>
	<p><b>例</b></p>
	<p class="example">使うファイルは　「ファイル処理.tts」<br>
	「ファイル処理.tts」を参照</p>
	<p>　</p>
</blockquote>

</body>

</html>