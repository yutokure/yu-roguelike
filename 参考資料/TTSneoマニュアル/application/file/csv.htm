<html>

<head>
	<meta http-equiv="Content-Language" content="ja">
	<meta name="GENERATOR" content="Microsoft FrontPage 12.0">
		<meta http-equiv="Content-Type" content="text/html; charset=shift_jis">
	<link rel="stylesheet" type="text/css" href="../../style.css">
	<title>CSV形式を操作する</title>
</head>

<body>

<div id="header">
	<div class="title">
		CSV形式を操作する</div>
	<div class="sub">
		TTSneoマニュアル</div>
	<div class="date">
		<!--webbot bot="Timestamp" s-type="EDITED" s-format="%Y/%m/%d" startspan -->2011/01/16<!--webbot bot="Timestamp" endspan i-checksum="12331" -->更新</div>
	<div class="navi">
		<a target="_parent" href="../../index.html">マニュアル</a> &gt; <a target="_parent" href="../index.htm">機能編</a> &gt; <a target="contents" href="../menu-office.htm">お仕事や雑用で使う</a> &gt;</div>
</div>
<h2>CSVファイルとは</h2>
<table border="0" cellpadding="10" cellspacing="0" width="100%">
	<tr>
		<td><img border="0" src="../../img/ttschar7.png" width="124" height="116"></td>
		<td>CSVとは、ファイル形式の１つで、表などのデータをカンマ（,）で区切ったテキストファイルのことです。<p>最近ではCSVファイルを使用することが少なくなりましたが、<br>
		Excelで開くことができ、メモ帳などで編集もできる形式のため、<br>
		簡単なデータベースなどを作る場合などは便利です。</p>
		</td>
	</tr>
</table>
<p>　</p>
<h2>CSVファイルを作成する</h2>
<blockquote>
	<p>２次配列を、CSVファイルとして保存すると、CSV形式に変換されて保存されます。 </p>
	<p>配列についての説明は、<a href="../../basic/arrange.htm">基本編の「配列を使う」</a>をご覧ください。 </p>
	<p>次のプログラムは、CSVファイルを保存する簡単な例です。 </p>
	<p class="example">データ（１，１）は、「たろう」<br>
	データ（１，２）は、「abc@xxx.com」<br>
	データ（１，３）は、「http://www.xxx.com/」<br>
	<br>
	データ（２，１）は、「はなこ」<br>
	データ（２，２）は、「def@xxx.com」<br>
	データ（２，３）は、「http://www.xxx.com/」<br>
	<br>
	データを「データ.csv」に保存</p>
	<p>プログラムを実行すると、次のような内容のCSVファイル「データ.csv」が作成されます。 </p>
	<p class="example">&quot;たろう&quot;,&quot;abc@xxx.com&quot;,&quot;http://www.xxx.com/&quot;<br>
	&quot;はなこ&quot;,&quot;def@xxx.com&quot;,&quot;http://www.xxx.com/&quot; </p>
	<p>２次配列を「データ（X,Y）」とすると、Xが行、Yが列を表します。 <br>
	配列のときと同じように、一行分一度に指定することもできます。 </p>
	<p class="example">データ（１，０）は、「たろう,abc@xxx.com,http://www.xxx.com/」<br>
	データ（２，０）は、「はなこ,def@xxx.com,http://www.xxx.com/」<br>
	<br>
	データを「データ.csv」に保存</p>
	<p>TTSneoの配列とCSV形式とは、少しデータ形式に違いがありますが、<br>
	「保存」命令を実行することで、CSV形式に変換されます。 </p>
</blockquote>
<p>　</p>
<h2>CSVファイルを開くには</h2>
<blockquote>
	<p>通常のテキストファイルを開く時と同様に「開け」関数を使用します。 </p>
	<p class="example">内容は　開け（［CSVファイル名］）</p>
	<p>これにより「内容」変数にCSVの内容が二次配列として、代入されます。 <br>
	例えば、１行２列目の内容を取り出すには、次のように書きます。 </p>
	<p class="example">内容は　開け（「データ.CSV」）<br>
	内容（１、２） を表示</p>
</blockquote>
<p>　</p>
<h2>処理する</h2>
<blockquote>
	<p>では、実際にCSVファイルを使ったプログラムを作ってみましょう。<br>
	例えば、次の表（成績表.CSV）をエクセルなどで作成します。 </p>
	<table border="1">
		<tr>
			<td>名前</td>
			<td>点数</td>
		</tr>
		<tr>
			<td>山田次郎</td>
			<td>56</td>
		</tr>
		<tr>
			<td>河野雄太</td>
			<td>82</td>
		</tr>
		<tr>
			<td>高橋裕香</td>
			<td>52</td>
		</tr>
		<tr>
			<td>佐藤美里</td>
			<td>90</td>
		</tr>
	</table>
	<p>この表の平均点を計算するプログラムを作ってみましょう。<br>
	平均値や偏差値といった計算の処理は、「繰り返せ」命令を使わずにシンプルに行うことができます。 </p>
	<p class="example">内容は　開け（「成績表.CSV」）<br>
	「平均点は　［平均（点数，２）］です。」を表示 </p>
	<p></p>
	<h4>２次配列対応の関数</h4>
	<p>次の関数は、直接２次配列から計算することができます。 </p>
	<table border="0" cellpadding="2">
		<tr>
			<td class="items">平均（[配列]、[列(省略可)]） </td>
			<td>配列の平均値を表します。<br>
			２次配列の場合、「列」を指定することができます。 </td>
		</tr>
		<tr>
			<td class="items">合計（[配列]、[列(省略可)]） </td>
			<td>配列の合計値を表します。 </td>
		</tr>
		<tr>
			<td class="items">偏差値（[配列]、[列(省略可)]） </td>
			<td>配列の偏差値を表します。 </td>
		</tr>
	</table>
</blockquote>
<p>　</p>
<h2>表オブジェクトを使う</h2>
<blockquote>
	<p>TTSneoには、「表」オブジェクトというエクセルの表のようなオブジェクトが用意されています。<br>
	表オブジェクトにCSVファイルの内容を入力したり、出力したりすることができます。 </p>
	<p class="example">ウィンドウ１を作れ<br>
	表１を作れ<br>
	表１のセルの量を２，５に変えろ<br>
	表１の大きさをウィンドウ１の中の幅、ウィンドウ１の中の高さに変えろ<br>
	表１をクリア<br>
	内容は　開け（「成績表.CSV」）<br>
	表１の一覧を内容に変えろ </p>
	<p>上のように、「表１の一覧を内容に変えろ」と命令することで、CSVファイルの内容を表に表示されることができます。 </p>
	<p>保存するときは、逆に次のように命令すれば調べることができます。 </p>
	<p class="example">表１の一覧を「成績表.CSV」へ保存 </p>
</blockquote>
<h4>選択した部分の内容を調べたい</h4>
<blockquote>
	<p>表オブジェクトの「選択一覧」設定項目で、選択したセルの２次配列として表します。 </p>
	<p class="example">合計（表１の選択一覧，１）を表示 </p>
</blockquote>
<p>　</p>
<h2>表の情報を処理するには</h2>
<blockquote>
	<p>表のデータは、配列ですので、TTSneoの配列に関係する関数や命令を使うことができます。<br>
	これらの機能を活用することで、より処理を効率化することができます。</p>
	<p class="steps"><b>▼参照</b><br>
	基本編→<a href="../../basic/arrange.htm">一つの変数にたくさんの情報を入れる『配列』</a><br>
	機能編→<a href="../arrange2.htm">配列を使ったいろいろな機能</a></p>
</blockquote>

</body>

</html>
