<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ミニゲーム: カウンターパッド</title>
    <link rel="stylesheet" href="../manual.css">
</head>
<body>
    <main>
        <h1>ミニゲーム: カウンターパッド</h1>

        <section>
            <h2>概要</h2>
            <p>
                カウンターパッドは、複数のカウンターを1画面で管理し、ボタンや直接入力で数値を増減できるユーティリティです。
                追加・編集・削除といった操作は即座にローカル保存されるため、タブを閉じたりゲームを離れても状態が復元されます。
                画面上部にはカウンター数、合計値、セッション中に得たEXPの集計チップが表示され、作業の全体像を把握しやすくなっています。
            </p>
        </section>

        <section>
            <h2>画面構成</h2>
            <dl>
                <dt>ヘッダー</dt>
                <dd>タイトルと「複数のカウントを素早く管理。増減操作は自動保存されます。」というサブタイトルが表示されます。</dd>
                <dt>サマリーバー</dt>
                <dd>「カウンター件数」「合計値」「セッションEXP」の3つのチップで進捗を確認できます。</dd>
                <dt>追加フォーム</dt>
                <dd>名称・初期値・ステップ値を指定して新しいカウンターを作成します。各フィールドにはローカライズ済みのプレースホルダーが入ります。</dd>
                <dt>カウンター一覧</dt>
                <dd>登録済みカウンターがカード形式で並びます。空の場合はガイダンスメッセージが表示されます。</dd>
            </dl>
        </section>

        <section>
            <h2>カウンターの追加</h2>
            <ul>
                <li>カウンターは最大32件まで作成できます。それ以上作ろうとすると警告が表示されます。</li>
                <li>名称欄は必須で、空白のみの場合は「新しいカウンター」テンプレートか「カウンター{番号}」が補われます。</li>
                <li>初期値は-1,000,000,000〜1,000,000,000の範囲に丸められ、未入力時は0になります。</li>
                <li>ステップ値は絶対値が1〜1,000,000の範囲で正の整数に補正され、未入力時は1が利用されます。</li>
                <li>カウンターを追加すると入力欄はクリアされ、次の入力に備えて名称欄へフォーカスが戻ります。</li>
                <li>作成時には5EXPが授与され、セッション集計に反映されます。</li>
            </ul>
        </section>

        <section>
            <h2>カウンターカードの操作</h2>
            <p>各カードには以下の操作が用意されています。</p>
            <ul>
                <li><strong>名称の変更:</strong> テキストボックスに直接入力し、フォーカスを離すと保存されます。32文字を上限にトリムされます。</li>
                <li><strong>削除:</strong> 削除ボタンを押すと確認ダイアログのあとでカードが一覧から取り除かれます。</li>
                <li><strong>値の確認と直接入力:</strong> 大きな表示と数値入力欄が並び、数値を直接指定して保存できます。</li>
                <li><strong>増減ボタン:</strong> 「±ステップ」「±ステップ×5」の4ボタンがあり、クリックするたびに値が調整されます。</li>
                <li><strong>ステップ値の変更:</strong> フッターの入力欄で正の整数を設定すると増減ボタンの単位も自動で更新されます。</li>
                <li><strong>リセット:</strong> リセットボタンで値を即座に0へ戻せます。</li>
            </ul>
            <p>
                いずれの操作でも結果は自動保存され、カードの一覧とサマリーが再描画されます。
            </p>
        </section>

        <section>
            <h2>EXPとセッション情報</h2>
            <ul>
                <li>カウンター作成時に5EXPが加算されます。</li>
                <li>値を増減すると、直前の変化から600ms以上経過している場合に差分値（最大10EXP）が授与されます。</li>
                <li>獲得EXPはセッション内で合計され、サマリーバーの「セッションEXP」に表示されます。</li>
                <li>セッションのスコアは <code>getScore()</code> からも参照でき、他システム連携用に利用可能です。</li>
            </ul>
        </section>

        <section>
            <h2>保存と復元の仕様</h2>
            <ul>
                <li>状態は操作のたびに250msディレイを挟んで <code>localStorage</code> の <code>mini_counter_state_v1</code> キーに保存されます。</li>
                <li>保存対象にはID・名称・値・ステップ値が含まれ、再読み込み時に自動で復元されます。</li>
                <li>名称・値・ステップ値はいずれも保存前にサニタイズされ、異常値が検出された場合でも安全な既定値に丸められます。</li>
                <li>ローカライズ設定を持つ環境では、言語切り替えに追従してラベルやフォーマットが更新されます。</li>
            </ul>
        </section>

        <section>
            <h2>制限事項とヒント</h2>
            <ul>
                <li>名称は前後の空白が除去され、32文字を超える部分は切り詰められます。</li>
                <li>値は常に整数として扱われ、範囲外に設定すると自動で上限・下限に揃えられます。</li>
                <li>ステップ値を大きくすると増減ボタンの変化量も大きくなるため、大幅な調整の際に活用してください。</li>
                <li>カウンターを多く登録する場合は、まとめたいカテゴリや目的ごとに名称テンプレートを活用すると識別しやすくなります。</li>
            </ul>
        </section>
    </main>
</body>
</html>
