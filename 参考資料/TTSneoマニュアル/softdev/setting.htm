<html>

<head>
<meta http-equiv="Content-Language" content="ja">
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta http-equiv="Content-Type" content="text/html; charset=shift_jis">
<link rel="stylesheet" type="text/css" href="../style.css">
<title>設定を保存・読み込む</title>
</head>

<body>

<div id="header">
	<div class="title">
		８．設定を保存・読み込む</div>
	<div class="sub">
		TTSneoマニュアル</div>
	<div class="navi">
		<a target="_parent" href="../index.html">マニュアル</a> &gt; <a target="_parent" href="index.htm">ソフト作り編</a> &gt;</div>
	<div class="date">
		<!--webbot bot="Timestamp" s-type="EDITED" s-format="%Y/%m/%d" startspan -->2005/02/13<!--webbot bot="Timestamp" endspan i-checksum="12417" -->更新</div>
</div>
<h2>ソフトの状態を保存する</h2>
<table border="0" cellpadding="10" cellspacing="0" width="100%">
	<tr>
		<td>ウィンドウのサイズや、パスワードやIDなどの設定は、次回起動したときにも設定が保存されていると、非常に便利です。<p>
		ここでは、設定の保存と読み込みを説明していきます。</td>
		<td><img border="0" src="../img/ttschar2.png" width="133" height="131"></td>
	</tr>
</table>
<h2>設定を保存する方法</h2>
<blockquote>
	<p class="neo">ねお　「次は設定を保存して、読み出す方法について説明するね」</p>
	<p class="tomo">とも　「どんなときに使うの？」</p>
	<p class="neo">ねお　「ソフトのオプション設定や、前回起動したときのウィンドウの位置や大きさなどの情報です。」</p>
	<p class="tomo">とも　「そういえば、いままでのソフトは、起動するたびにウィンドウの位置がまちまちだもんね。」</p>
	<p class="neo">
	ねお　「設定を保存する方法は、Windowsレジストリに保存する方法と、INIファイルという設定ファイルを作成してそこに保存する方法があります。」</p>
</blockquote>
<h4>Windowsレジストリとは</h4>
<blockquote>
	<p>Windowsに関する設定が保存されている共通の保存場所です。<br>
	一般的なソフトの設定は、すべてレジストリに記録されています。<br>
	設定の保存先が共通しているので、どのフォルダにプログラムがあっても同じ設定を読み書きできます。<br>
	現在では最も一般的な設定の保存方法です。</p>
</blockquote>
<h4>INIファイルとは</h4>
<blockquote>
	<p>メモ帳などで編集ができる設定ファイルのことです。<br>
	レジストリが利用される前は、一般的な設定の保存方法でした。<br>
	しかしINIファイルは、編集やコピーなどが簡単にできるので、場所や編集できるソフトが限られているレジストリよりも気軽に扱うことができます。</p>
	<p class="tomo">とも　「レジストリとINIファイルどちらを使えばいいの？」</p>
	<p class="neo">ねお　「うーん。状況や人の好みにもよるから、どちらとも言えないね<br>
	この説明を聞いて、自分の良いと思う方法で、やってみてください。」</p>
	<p class="tomo">とも　「わかった」</p>
</blockquote>
<p>　</p>
<h2>INIファイルに設定を保存する</h2>
<blockquote>
	<p class="neo">ねお　「まずは、INIファイルへの保存の方法を紹介するね<br>
	INIファイルの操作は、「設定」命令を使います。」</p>
	<p>まず、保存先のファイル名を指定します。<br>
	通常、INIファイルの拡張子は、iniですので、XXX.iniといった名前にしましょう。</p>
	<p class="format">設定ファイルは、[INIファイル名]</p>
	<p>ファイル名を指定したら、「設定」命令を使って、設定を書き込みます。</p>
	<p class="format"><span class="flag">[設定する内容]</span>を設定ファイルの<span class="flag">[種類名]</span>の<span class="flag">[項目名]</span>へ設定</p>
	<p><b><span class="flag">[種類名]</span></b>(セクション名)には、設定の分類<br>
	<b><span class="flag">[項目名]</span></b>(キー名)には、設定の項目名を指定してください。</p>
</blockquote>
<p><b>例</b>　INIファイルへウィンドウの情報を書き込む</p>
<p class="example">設定ファイルは、「［今の位置］setting.ini」<br>
ウィンドウ１の位置を、設定ファイルの「ウィンドウ」の「位置」へ設定<br>
ウィンドウ１の大きさを、設定ファイルの「ウィンドウ」の「大きさ」へ設定</p>
<p>　</p>
<h2>INIファイルから設定を読み込む</h2>
<blockquote>
	<p class="tomo">とも　「読み込むにはどうすればいいの？」</p>
	<p class="neo">ねお　「保存した設定ファイルの内容を読み込むには、「設定」関数を使います。」</p>
	<p class="format">設定（設定ファイルの<span class="flag">[種類名]</span>の<span class="flag">[項目名]</span>）</p>
	<p class="tomo">とも　「保存するときは「設定」命令で、読み込むときは「設定」関数なんだね」</p>
	<p class="neo">ねお　「そう。関数は結果が現れるものに使われるから、それを考えれば、迷わないと思うよ」</p>
</blockquote>
<p><b>例</b>　ウィンドウの情報を読み込む</p>
<p class="example">設定ファイルは　「［今の位置］setting.ini」<br>
ウィンドウ１を表示<br>
　　その背景を　標準に変えろ<br>
　　その位置を設定（設定ファイルの「ウィンドウ」の「位置」）に変えろ<br>
　　その大きさを設定（設定ファイルの「ウィンドウ」の「大きさ」）に変えろ<br>
<br>
待機<br>
<br>
手順は　ウィンドウ１を閉じる<br>
　　ウィンドウ１の位置を設定ファイルの「ウィンドウ」の「位置」へ設定<br>
　　ウィンドウ１の大きさを設定ファイルの「ウィンドウ」の「大きさ」へ設定<br>
　　ウィンドウ１を閉じる<br>
　　終了<br>
終わり</p>
<p>　</p>
<p align="center">
<img border="0" src="../img/ttschar5.png" width="126" height="130"></p>
<p>　</p>
<h2>レジストリへ設定を保存する</h2>
<blockquote>
	<p class="neo">ねお　「Windowsレジストリへ設定を保存するときにも「設定」命令を使います。」</p>
	<p class="tomo">とも　「設定は、みんな「設定」命令なんだね！」</p>
	<p class="format"><span class="flag">[設定する内容]</span>を<span class="flag">[ソフトの名前]</span>の<span class="flag">[項目名]</span>へ設定</p>
	<p><b><span class="flag">[ソフトの名前]</span></b>には、ソフトの名前<br>
	<b><span class="flag">[項目名]</span></b>には、設定の項目名を指定します。</p>
	<p class="neo">ねお　「レジストリには、他のソフトの設定も記録されているので、設定するときにそのプログラムだけの名前を指定してください。」</p>
	<p>　</p>
	<p>この方法で保存すると、レジストリの下の位置に保存されます。</p>
	<p class="example">HKEY_CURRENT_USER\Software\VB and VBA Program 
	Settings\TTScript\AppSettings\[ソフトの名前]の[項目名]</p>
</blockquote>
<p>　</p>
<h2>レジストリから設定を読み込む</h2>
<blockquote>
	<p class="neo">ねお　「設定ファイルの時と同じように、「設定」関数を使います。」</p>
	<p class="format">設定（[ソフト名]の[キーの名前]、[既定値(省略可能)]）</p>
	<p class="tomo">とも　「[既定値]には、何を指定するの？」</p>
	<p class="neo">ねお　「[既定値]には、設定が保存されていなかったときに表す内容を指定します。<br>
	(省略可能)になっているから、書かなくてもOKだよ」</p>
	<p class="neo">　</p>
</blockquote>
<p><b>例</b>　ウィンドウの情報をレジストリに保存・読み込む</p>
<p class="example">ウィンドウ１を表示<br>
　　その背景を標準に変えろ<br>
　　その位置を設定（testのウィンドウ位置、「１００、１００」）に変えろ<br>
　　その大きさを設定（testのウィンドウ大きさ、１００、１００」）に変えろ<br>
<br>
待機<br>
<br>
手順は　ウィンドウ１を閉じる<br>
　　ウィンドウ１の位置を「test」の「ウィンドウ位置」へ設定<br>
　　ウィンドウ１の大きさを「test」の「ウィンドウ大きさ」へ設定<br>
　　閉じる<br>
　　終了<br>
終わり</p>
<h4>　</h4>
<h2>設定を削除する</h2>
<h4>INIファイルの項目を削除</h4>
<blockquote>
	<p>INIファイルの項目を削除するには、下のように命令します。</p>
	<p class="format">設定ファイルの<span class="flag">[種類名]</span>の<span class="flag">[項目名]</span>を削除</p>
	<p class="example">設定ファイルの「TestApp」の「Name」を削除</p>
</blockquote>
<p>　</p>
<h4>レジストリの書き込みの削除</h4>
<blockquote>
	<p>レジストリに書き込まれたキーを削除するには、下のように命令します。</p>
	<p class="format"><span class="flag">[ソフト名]</span>の<span class="flag">[キーの名前]</span>に「」を設定</p>
</blockquote>
<p>　</p>
<h2>レジストリの好きな位置に保存する(技術者向け)</h2>
<blockquote>
	<p>先ほど以外の位置に、書き込みたい場合は、下のように命令します。<br>
	この方法は、TTSneo以外のソフトの重要な設定が保存されている場所の操作も可能なので、取り扱いには注意してください。</p>
	<p class="format"><span class="flag">[設定する内容]</span>をレジストリの<span class="flag">[キー名]</span>へ設定</p>
	<p>[キー名]には、レジストリのフルキーを指定します。</p>
	<p class="format">設定（レジストリの<span class="flag">[キー名]</span>、<span class="flag">[既定値(省略可能)]</span>）</p>
	<p>キーを削除するには、下のように命令します。</p>
	<p class="format">レジストリの<span class="flag">[キー名]</span>を削除</p>
</blockquote>

</body>

</html>
