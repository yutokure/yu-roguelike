<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ミニゲーム: 電卓</title>
    <link rel="stylesheet" href="../manual.css">
</head>
<body>
    <main>
        <h1>ミニゲーム: 電卓</h1>
        <section>
            <h2>概要</h2>
            <p>
                MiniExp の電卓は、日常的な四則演算を素早く処理できる <strong>標準モード</strong> と、基数変換や追加桁入力に対応した
                <strong>プログラマーモード</strong> を備えたユーティリティです。入力した数字は 1 回ごとに経験値を 1 取得でき、
                <kbd>=</kbd> で計算を確定すると追加で 5 の経験値が得られます。演算回数がそのままゲームスコアになるため、
                本編のリソース周回と併せて作業効率を高めたいときに便利です。
            </p>
        </section>
        <section>
            <h2>画面構成</h2>
            <ul>
                <li><strong>表示部:</strong> 入力中の式と結果を上段に分けて表示します。履歴やメモリの状態はステータスバーで確認できます。</li>
                <li><strong>モード切り替え:</strong> 標準 / プログラマーをワンタッチで切り替え、現在のモードと基数が要約表示されます。</li>
                <li><strong>プログラマー補助:</strong> プログラマーモード時は基数ボタン・追加桁パッド・他基数への同時変換パネルが現れます。</li>
                <li><strong>コントロール列:</strong> 符号反転、括弧、パーセント、メモリ操作などの補助ボタンをまとめた領域です。</li>
                <li><strong>テンキー:</strong> 数字・演算子・小数点・イコールを配置した 4×5 のキー配列で、<kbd>0</kbd> は 2 マス分を占有します。</li>
                <li><strong>履歴パネル:</strong> 計算を最大 50 件まで自動保存し、任意の項目を押すとそのまま再呼び出しできます。</li>
            </ul>
        </section>
        <section>
            <h2>標準モードでできること</h2>
            <h3>基本操作</h3>
            <ul>
                <li><strong>数字キー:</strong> 0〜9 を連続入力して数値を作成します。先頭 0 や <code>-0</code> は自動で整理されます。</li>
                <li><strong>演算子:</strong> <kbd>+</kbd> / <kbd>-</kbd> / <kbd>×</kbd> / <kbd>÷</kbd> の各ボタンで演算を追加します。</li>
                <li><strong>小数点:</strong> <kbd>.</kbd> は 1 度だけ挿入され、小数計算に対応します。</li>
                <li><strong>括弧:</strong> <kbd>(</kbd> / <kbd>)</kbd> を用いて優先順位を調整し、電卓側でバランスをチェックします。</li>
                <li><strong>⌫:</strong> 直前の文字を削除します。式が空になってもエラーにはなりません。</li>
                <li><strong>AC:</strong> 入力中のトークンと結果をすべてクリアし、初期状態に戻します。</li>
                <li><strong>%:</strong> 現在の値を 100 で割り、割合計算を素早く行えます。</li>
                <li><strong>+/-:</strong> 選択中の数値の符号を反転します。式中の最後の数値にも適用できます。</li>
                <li><strong>=:</strong> トークン列を評価して結果を表示し、履歴に保存します。</li>
            </ul>
            <h3>メモリ機能</h3>
            <ul>
                <li><strong>MR:</strong> 記憶している値を呼び出して現在の入力にセットします。</li>
                <li><strong>M+ / M-:</strong> 表示中の値をメモリに加算・減算します。未設定時は 0 から開始します。</li>
                <li><strong>MC:</strong> メモリをクリアして <code>M: --</code> 状態に戻します。保存内容はローカルストレージにも反映されます。</li>
            </ul>
        </section>
        <section>
            <h2>プログラマーモード活用術</h2>
            <p>
                プログラマーモードでは 2・4・6・8・10・16・24・30 進数を切り替えながら値を編集できます。各基数ごとに使用可能な桁が
                自動で制限され、A〜T までのアルファベット専用パッドが有効になります。変換パネルには全基数での表記が即座に反映される
                ため、基数を変えた際の表現差を確認しながら計算できます。
            </p>
            <ul>
                <li><strong>基数ボタン:</strong> 任意の基数を選択すると桁入力が更新され、必要なら現在の入力もリセットされます。</li>
                <li><strong>補助桁:</strong> 16 進以上を扱う際はアルファベットキーで桁を追加します。</li>
                <li><strong>変換表:</strong> 現在値を全基数へ同時変換して表示し、桁数や値をコピーしやすくします。</li>
                <li><strong>パーセント・符号反転:</strong> 進数変換後も利用可能で、内部的には 10 進に戻して演算してから表示を変換します。</li>
                <li><strong>履歴復元:</strong> 履歴から呼び出すと基数設定と結果が自動復元されるため、別基数で編集し直す際にも便利です。</li>
            </ul>
        </section>
        <section>
            <h2>履歴とローカル保存</h2>
            <p>
                計算結果は最新順で最大 50 件まで保存されます。履歴をクリックするとその式と結果が再表示され、プログラマーモードで保存
                した項目は基数情報も復元します。履歴クリアボタンで一括削除でき、データはローカルストレージに自動保存されるため、
                ブラウザを閉じてもメモリ値と履歴が残ります。</p>
        </section>
        <section>
            <h2>キーボードショートカット</h2>
            <ul>
                <li><kbd>0</kbd>〜<kbd>9</kbd> / <kbd>A</kbd>〜<kbd>T</kbd>（許可基数のみ）: 直接桁を入力。</li>
                <li><kbd>+</kbd> / <kbd>-</kbd> / <kbd>*</kbd> / <kbd>/</kbd>: 四則演算子を入力（乗算は自動で <kbd>×</kbd>、除算は <kbd>÷</kbd> に変換）。</li>
                <li><kbd>.</kbd> または <kbd>,</kbd>: 小数点を挿入。</li>
                <li><kbd>%</kbd>: パーセント変換。</li>
                <li><kbd>(</kbd> / <kbd>)</kbd>: 括弧を追加。</li>
                <li><kbd>Enter</kbd> / <kbd>=</kbd>: 計算を実行。</li>
                <li><kbd>Backspace</kbd>: バックスペース。</li>
                <li><kbd>Escape</kbd>: 全クリア。</li>
            </ul>
        </section>
        <section>
            <h2>スコアと経験値の仕組み</h2>
            <p>
                電卓のスコアは「これまでに確定した計算回数」です。数字を 1 桁入力するごとに 1 XP、計算確定で 5 XP が付与されるため、
                大きな式を分割してこまめに評価すると経験値効率が向上します。計算に失敗した場合は「エラー」表示となりますが、
                クリアすればすぐに再入力が可能です。</p>
        </section>
        <section>
            <h2>活用のヒント</h2>
            <ul>
                <li>桁数が多い場合は履歴から再利用して誤入力を防ぎましょう。必要に応じて一度結果を確定し、履歴をブックマーク代わりに使えます。</li>
                <li>基数の切り替えは <strong>モード変更後のリセット</strong> が入るため、変換前に一度 <kbd>=</kbd> で確定して履歴を残しておくと安全です。</li>
                <li>メモリは複数の式で共通の値を参照したいときに有効です。たとえば税率や係数を M+ で保持し、必要に応じて MR で呼び出します。</li>
                <li>プログラマーモードで桁が許可されない場合は、対象基数で利用できる桁のみが受け付けられているか確認してください。</li>
            </ul>
        </section>
    </main>
</body>
</html>
