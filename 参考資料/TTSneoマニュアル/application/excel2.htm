<html>

<head>
<meta http-equiv="Content-Language" content="ja">
<meta name="GENERATOR" content="Microsoft FrontPage 12.0">
<meta http-equiv="Content-Type" content="text/html; charset=shift_jis">
<link rel="stylesheet" type="text/css" href="../style.css">
<title>Excelを操作する(応用編)</title>
<style type="text/css"></style>
</head>

<body>

<div id="header">
	<div class="title">
		Excelを操作する(応用編)</div>
	<div class="sub">
		TTSneoマニュアル</div>
	<div class="date">
		<!--webbot bot="Timestamp" s-type="EDITED" s-format="%Y/%m/%d" startspan -->2008/07/01<!--webbot bot="Timestamp" endspan i-checksum="12756" -->更新</div>
	<div class="navi">
		<a target="_parent" href="../index.html">マニュアル</a> &gt; <a target="_parent" href="index.htm">機能編</a> &gt; <a target="contents" href="menu-office.htm">お仕事や雑用で使う</a> &gt;</div>
</div>
<h2>マクロの実行</h2>
<blockquote>
	<p>エクセルで定義したマクロを、TTSneoから実行することができます。</p>
	<p>ワークブックに含まれるマクロを実行するには、下のように命令します。 <br>
	この場合、モジュールに定義した「TestMacro」というマクロを実行します。</p>
	<p class="example"><span class="rem">ーーマクロ実行</span><br>
	エクセルの「TestMacro」をマクロ実行<br>
	<br>
	<span class="rem">ーー戻り値を得る場合</span><br>
	マクロ実行（「TestMacro」）を表示</p>
	<p>※マクロは、Excelの「ツール」−「マクロ」−「マクロ」または「Visual Basic Editor」で作成します。<br>
	　詳しくは、エクセルのヘルプなどをご覧下さい。</p>
	<h3><b>シートの関数を呼び出す</b></h3>
	<p>各シートに定義した関数を呼び出す場合は、シート名を指定します。<br>
	次の例では、Sheet1に定義した「Sub TestMacro()」を実行します。</p>
	<p class="example"><span class="rem">ーーSheet1のTestMacroを実行</span><br>
	エクセルの「Sheet1.TestMacro」をマクロ実行</p>
	<h3><b>引数を指定する場合</b></h3>
	<p>引数を指定する関数の場合、「〜で」に引数を配列形式で指定します。<br>
	ただし、VBA関数の引数は、必ず文字列型(String)である必要があります。<br>
	また、指定できる引数の数は、10個までです。</p>
	<p class="vb">' VBAのコード<br>
	Function TestMacro2(ByVal Value As String, ByVal Title As String) As String<br>
&nbsp;&nbsp;&nbsp; MsgBox Value, Title<br>
&nbsp;&nbsp;&nbsp; TestMacro2 = &quot;戻り値です&quot;<br>
	End Sub</p>
	<p class="example"><span class="rem">ーー引数のあるマクロ実行</span><br>
	エクセルの「TestMacro2」を「こんにちは,メッセージ」でマクロ実行<br>
	<br>
	<span class="rem">ーー戻り値を得る場合</span><br>
	エクセルのマクロ実行（「TestMacro2」、「こんにちは,メッセージ」）を表示</p>
</blockquote>
<p>&nbsp;</p>
<h2>ワークブックやワークシートに関する操作</h2>
<blockquote>
	<h3>ワークブックやワークシートの切り替え</h3>
	<p>ワークブックやワークシートを切り替えるには、下のように命令します。 </p>
	<p class="example">エクセルのワークシートを「Sheet1」に変えろ</p>
	<p class="example">エクセルのワークブックを「成績表.xls」に変えろ</p>
	<p>数値（左から１、２、…）で指定することもできます。 </p>
	<p>　</p>
	<h3>エクセルで開いているファイルの一覧を取得する</h3>
	<p class="example">エクセルのワークブック一覧を表示する</p>
	<h4>ワークブックに含まれているワークシートの一覧を取得する</h4>
	<p class="example">エクセルの現在ブックのワークシート一覧を表示する</p>
</blockquote>
<p>　</p>
<blockquote>
	<h3>ワークシートの追加</h3>
	<p>TTSneo上から、ワークブックに含まれているワークシートの変更を行うことができます。</p>
	<p class="example"><span class="rem">ーー新しいワークシートを追加します</span><br>
	エクセルのワークシートを追加</p>
	<h3>ワークシートの削除</h3>
	<p class="example"><span class="rem">ーー現在選択しているワークシートを削除します</span><br>
	エクセルの現在シートを削除</p>
	<h3>ワークシートのコピー</h3>
	<p class="example"><span class="rem">ーー現在選択しているワークシートをコピーします<br>
	</span>エクセルの現在シートを[移動先]へコピー</p>
	<h3>ワークシートの並び順の変更</h3>
	<p class="example"><span class="rem">ーー現在選択しているワークシートを[移動先]へ移動します<br>
	</span>エクセルの現在シートの[コピー先]へ移動</p>
	<p>&nbsp;</p>
</blockquote>
<h2>エクセルの状態を調べる</h2>
<blockquote>
	<p>エクセルの情報を調べるための設定項目が用意されています。</p>
	<p><b>エクセルのバージョン</b><br>
	　Microsoft Excelのバージョン情報を取得できます</p>
	<p><b>エクセルの起動中</b><br>
	　エクセルが起動しているかどうか調べます</p>
	<p><b>エクセルのファイル名</b><br>
	　現在選択しているワークブックのファイル名を表します</p>
</blockquote>
<p>　</p>
<h2>エクセル連係の拡張</h2>
<blockquote>
	<p>TTSneoでサポートしているExcelの機能は、ほんの一部です。<br>
	Excelには様々な機能が用意されており、それらの機能すべてを対応することはできません。</p>
	<p>しかし、少しでもTTSneo上で操作ができるように、VBAで利用できるプロパティの一部を、TTSneo上で直接指定することができます。</p>
	<p>
	コレクションを含むオブジェクトの指定やメソッドには対応していませんが、値の設定や取得など、TTSneoでサポートしていない最低限の情報を取得することができます。</p>
	<p class="example"><span class="rem">ーーワードアートのテキストを設定、取得する例</span><br>
	エクセルをリンク<br>
	エクセルの図形の「ワードアート 1」のTextEffect.textを、時間に変えろ<br>
	内容は、エクセルの図形の「ワードアート 1」の<span class="pink">TextEffect.text</span><br>
	内容を表示</p>
</blockquote>
<p>　</p>

</body>

</html>
