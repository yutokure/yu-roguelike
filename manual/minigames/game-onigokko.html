<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ミニゲーム: 鬼ごっこ</title>
    <link rel="stylesheet" href="../manual.css">
</head>
<body>
    <main>
        <h1>ミニゲーム: 鬼ごっこ</h1>
        <section>
            <h2>概要</h2>
            <p>
                <strong>鬼ごっこ</strong> は混合型ダンジョンを舞台に、複数の鬼から逃げながら制限時間を生き延びるミニゲームです。
                ステージは毎回 MiniExp のダンジョン API で 40&times;30 タイルの迷路状に生成され、
                壁との当たり判定を保ったままスムーズに移動できます。
                生存中は毎秒 <strong>+3XP</strong> が加算され、タイマーを 0 まで耐え切ると難易度に応じた逃走ボーナスが得られます。
            </p>
        </section>
        <section>
            <h2>ゲームの流れ</h2>
            <ol>
                <li>MiniExp メニューから <strong>鬼ごっこ</strong> を選択すると、ダンジョン API が自動で混合型ステージを生成します。</li>
                <li>読み込み完了後にステータスが「準備完了」となり、<strong>開始</strong> 操作でラウンドがスタートします。</li>
                <li>制限時間が 0 になる前に鬼に接触すると即座に失敗となり、そのラウンドでは EXP を受け取れません。</li>
            </ol>
            <p class="small-note">ダンジョン API が利用できない環境では「ダンジョンAPIが利用できません」と表示され、ステージ生成に失敗すると専用のエラーメッセージが通知されます。</p>
        </section>
        <section>
            <h2>操作方法</h2>
            <ul>
                <li><kbd>↑</kbd> / <kbd>↓</kbd> / <kbd>←</kbd> / <kbd>→</kbd> または <kbd>W</kbd> / <kbd>A</kbd> / <kbd>S</kbd> / <kbd>D</kbd>: プレイヤーを 360 度移動します。</li>
            </ul>
            <p>斜め移動時は内部で正規化されるため、縦横と同じ移動速度で滑らかに曲がれます。</p>
        </section>
        <section>
            <h2>ステージとキャラクター</h2>
            <ul>
                <li>ステージは 18px グリッド相当の床タイルで構成され、壁との衝突を細分化ステップで処理しているため角を滑るように移動できます。</li>
                <li>初期スポーン付近には淡い安全地帯のシェーディングがあり、開始直後の位置関係を確認しやすくなっています。</li>
                <li>鬼は 0.3 タイル径の円として描画され、0.35 秒前後（難易度によって変化）ごとにプレイヤーへの経路を BFS で再探索します。</li>
                <li>鬼との接触判定は円同士の距離で計算され、重なった瞬間に捕まります。</li>
            </ul>
        </section>
        <section>
            <h2>難易度別パラメータ</h2>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>難易度</th>
                            <th>制限時間</th>
                            <th>鬼の数</th>
                            <th>プレイヤー速度</th>
                            <th>鬼の速度</th>
                            <th>経路再計算間隔</th>
                            <th>逃走ボーナス</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>EASY</td>
                            <td>55 秒</td>
                            <td>2 体</td>
                            <td>タイル毎秒 ×3.6</td>
                            <td>タイル毎秒 ×2.9</td>
                            <td>約 0.42 秒ごと</td>
                            <td>+110XP</td>
                        </tr>
                        <tr>
                            <td>NORMAL</td>
                            <td>65 秒</td>
                            <td>3 体</td>
                            <td>タイル毎秒 ×4.0</td>
                            <td>タイル毎秒 ×3.3</td>
                            <td>約 0.34 秒ごと</td>
                            <td>+140XP</td>
                        </tr>
                        <tr>
                            <td>HARD</td>
                            <td>75 秒</td>
                            <td>3 体</td>
                            <td>タイル毎秒 ×4.6</td>
                            <td>タイル毎秒 ×3.7</td>
                            <td>約 0.28 秒ごと</td>
                            <td>+180XP</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <p>全難易度で生存 1 秒ごとに +3XP のサバイバル報酬が入り、逃げ切り時のみボーナス EXP を獲得できます。</p>
        </section>
        <section>
            <h2>UI の見かた</h2>
            <ul>
                <li>上部インフォパネル左側に残り時間が表示され、0.01 秒単位で更新されます。</li>
                <li>同パネル右側には現在のステータスが表示され、「鬼ごっこ開始」「捕まってしまった！獲得EXPなし」「見事逃げ切った！」などの進行状態が切り替わります。</li>
                <li>キャンバスにはプレイヤー（青）と鬼（赤）が描画され、背景には生成済みダンジョンが表示されます。</li>
            </ul>
        </section>
        <section>
            <h2>攻略のヒント</h2>
            <ul>
                <li>鬼は経路再計算のタイミングまで前回の目標を追うため、角を曲がって視界を切ると一時的に距離を稼げます。</li>
                <li>通路の幅が狭い場所では鬼の円に接触しやすいので、1 タイル以上の余裕がある広場に誘導して回避しましょう。</li>
                <li>終盤でタイマーが 5 秒を切ったら、安全地帯付近に戻って時間稼ぎすると確実に逃げ切りボーナスを得られます。</li>
            </ul>
        </section>
    </main>
</body>
</html>
