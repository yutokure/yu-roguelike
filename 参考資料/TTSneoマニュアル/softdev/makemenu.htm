<html>

<head>
<meta http-equiv="Content-Language" content="ja">
<meta http-equiv="Content-Type" content="text/html; charset=shift_jis">
<link rel="stylesheet" type="text/css" href="../style.css">
<title>メニューを作る</title>
</head>

<body>

<div id="header">
	<div class="title">
		７．メニューを作る</div>
	<div class="sub">
		TTSneoマニュアル</div>
	<div class="navi">
		<a target="_parent" href="../index.html">マニュアル</a> &gt; <a target="_parent" href="index.htm">ソフト作り編</a> &gt;</div>
	<div class="date">
		<!--webbot bot="Timestamp" s-type="EDITED" s-format="%Y/%m/%d" startspan -->2007/06/03<!--webbot bot="Timestamp" endspan i-checksum="12688" -->更新</div>
</div>
<h2>ソフトには欠かせないメニュー</h2>
<blockquote>
	<p class="neo">ねお　「TTSneoのウィンドウにメニューを付けることができます。<br>
	「メニュー」というのは、ウィンドウの上部にある「ファイル(F)」「ヘルプ(H)」などの項目のことです。」</p>
	<p class="tomo">とも　「TTSneoでもメニューが作れるんだぁ」</p>
	<p class="neo">ねお　「メニューを作るには、「作れ」命令を使います。」</p>
	<p class="format">メニュー　<span class="flag">[メニューの名前]</span>を作れ<br>
	サブメニュー　<span class="flag">[メニューの項目の名前]</span>を作れ</font></p>
	<p class="tomo">とも　「サブメニューって言うのは、何？」</p>
	<p class="neo">ねお　「メニューと言うのは、ウィンドウに表示される見出しのメニューのことです。<br>
	サブメニューと言うのは、メニューの中にある項目のことです。」</p>
</blockquote>
<p>　</p>
<h4>メニューの例</h4>
<blockquote>
	<p class="neo">ねお　「メニューを使ったプログラムを作ってみましょう。」</p>
</blockquote>
<p class="example">ウィンドウ１を使う<br>
<br>
メニュー　「ファイル」を作れ<br>
サブメニュー　「開く」を作れ<br>
サブメニュー　「<font color="#ff0000">-</font>」を作れ<br>
サブメニュー　「終了」を作れ<br>
<br>
ウィンドウ１を表示<br>
<br>
待機</p>
<p>　</p>
<h4>区切り線を入れたい</h4>
<blockquote>
	<p class="tomo">とも　「上の例を見ると、メニューの名前を「<font color="#ff0000"><b>-</b></font>」にすると線になるんだね」</p>
	<p class="neo">ねお　「そう、メニューの名前を「<font color="#ff0000"><b>-</b></font>」とすることで、メニューの区切り線にすることができます。」</p>
	<p><b><font color="#ff0000">※</font></b>メニューの名前は、必ず&quot;「」&quot;で囲むようにしましょう。<br>
	囲まないと正しく表示されない場合があります。</p>
</blockquote>
<p>　</p>
<h2>メニューの項目をクリックした時の手順</h2>
<blockquote>
	<p class="neo">ねお　「上のプログラムのメニューをクリックしても、何も反応しません。<br>
	メニューをクリックしたときのプログラムは、オブジェクトを作った時のように「手順」を作らなければなりません。」</p>
	<p class="tomo">とも　「なるほど、オブジェクトと同じように作ればいいんだね」</p>
	<p class="format">手順は　<span class="flag">[ウィンドウ名]</span>の<span class="flag">[メニューの名前]</span>の<span class="flag">[メニューの項目の名前]</span>をクリック<br>
	<br>
	終わり</p>
	<p class="neo">ねお　「では、さっきのプログラムに手順を追加してみましょう。」</p>
</blockquote>
<p class="example">手順は　ウィンドウ１のファイルの終了をクリック<br>
　　ウィンドウ１を閉じる<br>
　　終了<br>
終わり</p>
<blockquote>
	<p class="tomo">とも　「「終了」をクリックすると、ちゃんと終了するんだね」</p>
	<p><b><font color="#ff0000">注意</font></b>　<font color="#ff0000">手順名には、関数や変数を指定することはできません。</font></p>
</blockquote>
<p>　</p>
</font></font></font>
<h2>たくさんの階層のメニュー</h2>
<blockquote>
	<p class="tomo">とも　「メニューの中にメニューを作ることはできるの？」</p>
	<p class="neo">ねお　「メニューの中にさらにメニューの項目を作りたい場合は、<font color="#ff0000"><b>[メニューの項目の名前]</b></font>の前に&quot;<font color="#ff0000"><b>＞</b></font>&quot;をつけます。」</p>
	<p>こうすると、メニュー項目の中にさらにメニューを作ることができます。</p>
	<p class="format">サブメニュー　<font color="#ff0000">＞</font>「○○」を作れ</p>
	<p class="neo">ねお　「元の階層に戻したいときは、「<b><font color="#ff00ff">サブメニュー　＜を作れ</font></b>」のように命令します。」</p>
</blockquote>
<p><font size="3"><b>例</b>　複雑なメニューの項目を作ります。</font></p>
<p class="example">ウィンドウ１を使う<br>
<br>
メニュー　「ファイル」を作れ<br>
サブメニュー　「終了」を作れ<br>
<br>
メニュー　「ツール」を作れ<br>
サブメニュー　＞「外部」を作れ<br>
サブメニュー　「ツール１」を作れ<br>
サブメニュー　「ツール２」を作れ<br>
サブメニュー　＜を作れ<br>
サブメニュー　「オプション」を作れ<br>
<br>
ウィンドウ１を表示<br>
<br>
待機<br>
<br>
<span class="rem">ーー「ツール」メニューの「外部」の「ツール１」をクリックした時</span><br>
手順は　ウィンドウ１のツールの外部のツール１をクリック<br>
　　「外部のツール１をクリックしました」を表示<br>
終わり</p>
</font>
<p>　</p>
<h2>何か寂しい・・・！</h2>
<blockquote>
	<p class="tomo">とも　「メニューはできたけれど、なんか味気ないような・・・何が足りないんだろう？・・・<br>
	あっ　そう、「<b>(<u>F</u>)</b>」とか「<b>(<u>H</u>)</b>」とかがない！」</p>
	<p class="neo">
	ねお　「そう、これは、ショートカットキーが利用できることを表す記号で、[Alt]+[F]や[H]でそのメニューを出すことができる機能です。」</p>
	<p class="tomo">とも　「そんな意味があったんだぁ」</p>
	<p class="neo">ねお　「この機能を入れることで、さらに使いやすいプログラムを作ることができます。<br>
	では、それをプログラムに入れてみましょう。」</p>
	<p>手順を指定するときも<font color="#ff0000"><b>(&amp;F)</b></font>や<font color="#ff0000"><b>(&amp;X)</b></font>を必ず付けて下さい。</p>
</blockquote>
<p class="example">ウィンドウ１を使う<br>
<br>
メニュー　「ファイル<font color="#ff0000">(&amp;F)</font>」を作れ<br>
サブメニュー　「開く<font color="#ff0000">(&amp;O)</font>」を作れ<br>
サブメニュー　「-」を作れ<br>
サブメニュー　「終了<font color="#ff0000">(&amp;X)</font>」を作れ<br>
<br>
ウィンドウ１を表示<br>
<br>
待機<br>
<br>
手順は　ウィンドウ１のファイル<font color="#ff0000">(&amp;F)</font>の終了<font color="#ff0000">(&amp;X)</font>をクリック<br>
　　ウィンドウ１を閉じる<br>
　　終了<br>
終わり</p>
<p align="center">
<img border="0" src="../img/ttschar.png" width="128" height="124"></p>
<h2><a name="メニューの編集">ウィンドウの設計でメニューを作成する</a></h2>
<blockquote>
	<p class="neo">ねお　「実は、わざわざプログラムを書かなくても、TTSneoデザイナでメニューを作ることもできるんだよ」</p>
	<p class="tomo">とも　「えっ、そうなの？それを早く言ってよっ！！」</p>
	<p class="neo">ねお　「でもメニューを作るにはどのように命令すればよいか知っておくことは大切だから、プログラムの書き方を覚えて無駄ではないよ」</p>
	<p class="tomo">とも　「わかった。で、TTSneoデザイナではどうやって作るの？」</p>
	<p class="neo">ねお　「まず、「ウィンドウの設計」画面を開いて、その画面の左上のTTSneoのボタンをクリックします。<br>
	メニューが表示されるので、「メニューの編集」をクリックします。」</p>
	<p class="neo"><img border="0" src="makemenu.png" width="407" height="218"></p>
	<p class="tomo">とも　「「メニューの編集」画面が出てきた。上のボタンでメニューを追加していくんだね？」</p>
	<p class="neo">ねお　「そうです。まず[メニュー追加]ボタンをクリックして、大本の項目を追加します。<br>
	あとは、[項目追加]ボタンで、各メニューの項目を追加していきます。」</p>
	<p><img border="0" src="makemenu2.png" ></p>
	<p class="neo">ねお　「メニューをクリックしたときの手順を作るには、項目をダブルクリックするか、[手順の表示]をクリックします。」</p>
	<h4>　</h4>
	<h4>項目の説明</h4>
	<p>別名・・・メニュー項目の別名を指定します。ここで指定した別名は、「変えろ」命令などをメニューを指定する際に使用します。</p>
	<p>ショートカットキー・・・ウィンドウ上で押したキーの組み合わせと、メニュー項目を対応付けます。<br>
	指定したショートカットキーを押すと、そのメニュー項目の手順が実行されます。</p>
	<p>アイコン・・・メニュー項目のアイコンを指定します。</p>
	<p>[手順の表示]・・・選択している項目の手順を表示します。</p>
	<p>　</p>
</blockquote>
<h2>メニューの項目の名前を変えたい</h2>
<blockquote>
	<p class="tomo">とも　「メニューの名前は、作った後で変えるにはどうすればいいの？」</p>
	<p class="neo">ねお　「メニューを作った後に名前を変えたい場合は、下のようにプログラムしてください。」</p>
	<p><b>書式</b></p>
	<p class="format">メニューの<span class="flag"><b>[メニューの名前]</b></span>の<b><span class="flag">[設定項目]</span></b>を<b><span class="flag">[内容]</span></b>に変えろ</p>
	<p><span class="flag"><b>[メニューの名前]</b></span>には、メニューの名前を指定します。<br>
	たとえば、「ファイル」メニューの「開く」の場合は、「ファイルの開く」と指定します。<br>
	ここで指定する名前は、「作れ」命令で指定したときの名前です。名前を変更した後でも変わりません。</p>
	<p><b><span class="flag">[設定項目]</span></b>には、変えたい項目を指定します。<br>
	「名前」「チェック」などが指定できます。</p>
</blockquote>
<p><b>例</b>　「１」という項目を追加して、名前を変える</p>
<p class="example">ウィンドウ１を使う<br>
<br>
メニュー　「ファイル」を作れ<br>
サブメニュー　「開く」を作れ<br>
サブメニュー　「-」を作れ<br>
サブメニュー　「終了」を作れ<br>
<br>
サブメニュー　「１」を作れ<br>
<font color="#FF00FF"><b>メニューのファイルの１の名前を時間に変えろ</b></font><br>
<br>
ウィンドウ１を表示<br>
<br>
待機<br>
<br>
手順は　ウィンドウ１のファイルの１をクリック<br>
　　「こんにちは」を表示<br>
終わり</p>
<blockquote>
	<p class="tomo">とも　「名前を変えた後は、手順名も変えないといけないんだよね？」</p>
	<p class="neo">ねお　「違うよ。メニューをクリックした時の手順名は、最初に指定した名前を使います。」</p>
	<p class="tomo">とも　「そっか。じゃプログラムを変える必要はないんだね」</p>
</blockquote>
<p>　</p>
<h2>チェック印を入れたい</h2>
<blockquote>
	<p class="tomo">とも　「メニューにチェックを入れることはできる？」</p>
	<p class="neo">ねお　「メニューの項目にチェックを入れたい場合は、「チェック」設定項目を使います。」</p>
</blockquote>
<p class="example">もし　メニューのツール(&amp;T)のチェック(&amp;C)のチェックは　オフ　なら<br>
　　メニューのツール(&amp;T)のチェック(&amp;C)のチェックを、オンに変えろ<br>
でないなら<br>
　　メニューのツール(&amp;T)のチェック(&amp;C)のチェックを、オフに変えろ<br>
もし終わり</p>
<blockquote>
	<p class="tomo">とも　「リファレンスを見ると、いろいろ書いてあるね！」</p>
	<p class="neo">ねお　「うん！　ここで説明できなかったこともあるから、リファレンスはよく見たほうがいいよ」</p>
</blockquote>
<p>　</p>
<h2>ポップアップメニューを表示したい</h2>
<blockquote>
	<p class="tomo">とも　「他のソフトでよくある右クリックしたときに表示されるメニューは作れないの？」</p>
	<p class="neo">ねお　「もちろんできます。文章テキストのように自動的に表示してくれるものもあるけれど、<br>
	自分でメニューの項目を作ることもできます。このメニューのことをポップアップメニューと言います。」</p>
</blockquote>
<p><b>ポップアップメニューの作り方</b></p>
<p class="steps">１．ウィンドウにメニューを作る<br>
２．「ポップアップ」命令でメニューを呼び出す</p>
<p>　</p>
<p><b>ポップアップメニューを表示される例</b></p>
<p class="example">ウィンドウ１を使う<br>
メニュー　「編集(&amp;E)」を作れ<br>
サブメニュー　「コピー」を作れ<br>
ウィンドウ１を表示<br>
待機<br>
<br>
手順は　ウィンドウ１でマウスのボタンを上げる<br>
　　もし　押したボタンは　２　なら<br>
　　　　<b><font color="#FF00FF">「編集(&amp;E)」をポップアップメニュー</font></b><br>
　　もし終わり<br>
終わり <br>
<br>
手順は　ウィンドウ１の編集(&amp;E)のコピーをクリック<br>
　　「コピーをクリックしました。」を、情報で表示<br>
終わり</p>
<p class="tomo">　</p>
<blockquote>
	<p class="tomo">とも　「ウィンドウの上にメニューを表示させないようにできないの？」</p>
	<p class="neo">ねお　「そのときは、メニューを他のウィンドウに作ってください。<br>
	ポップアップメニュー命令は、他のウィンドウでも良いので、別のウィンドウのメニューを表示させるようにすれば、うまくできます。」</p>
</blockquote>
<p>　</p>
<p class="example">メニュー作成<br>
ウィンドウ１を表示<br>
待機<br>
<br>
手順は　メニュー作成<br>
　　<span class="rem">ーーウィンドウ２にメニューを作成しておく</span><br>
　　ウィンドウ２を使う<br>
　　メニュー　「編集(&amp;E)」を作れ<br>
　　サブメニュー　「コピー」を作れ<br>
終わり<br>
<br>
手順は　ウィンドウ１でマウスのボタンを上げる<br>
　　もし　押したボタンは　２　なら<br>
　　　　ウィンドウ２を使う<br>
　　　　「編集(&amp;E)」をポップアップメニュー<br>
　　もし終わり<br>
終わり <br>
<br>
手順は　ウィンドウ２の編集(&amp;E)のコピーをクリック<br>
　　「コピーをクリックしました。」を、情報で表示<br>
終わり</p>

</body>

</html>
