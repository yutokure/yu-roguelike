<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ミニゲーム: タイマー</title>
    <link rel="stylesheet" href="../manual.css">
</head>
<body>
    <main>
        <h1>ミニゲーム: タイマー</h1>

        <section>
            <h2>概要</h2>
            <p>
                タイマーは <strong>カウントダウン</strong> と <strong>ストップウォッチ</strong> の 2 モードを切り替えて利用できる時間管理用ユーティリティです。
                画面上部にはセッションで獲得した EXP 合計が表示され、下部には行動ログが最大 8 件まで記録されます。
                標準では前回利用時の設定を自動で保存し、次回起動時に再利用します。
            </p>
        </section>

        <section>
            <h2>初期設定と保存</h2>
            <ul>
                <li>初回起動時のカウントダウン時間は 5 分（00:05:00）に設定されています。</li>
                <li>モードと時間入力（時間・分・秒）はローカルストレージ <code>mini_timer_prefs_v1</code> に保存され、次回起動時に自動で復元されます。</li>
                <li>保存されていない、または 0 秒の設定を読み込んだ場合は安全のため 5 分にリセットされます。</li>
            </ul>
        </section>

        <section>
            <h2>カウントダウンモード</h2>
            <p>モードトグルで <strong>カウントダウン</strong> を選択すると、以下の UI が利用できます。</p>
            <ul>
                <li>時間・分・秒入力欄：0〜23 時間、0〜59 分、0〜59 秒の範囲で設定します。稼働中は誤操作防止のため入力欄が無効化されます。</li>
                <li>クイック設定ボタン：+1/+5/+10 分、-1 分、25 分ポモドーロのプリセットをワンクリックで反映します。0 分以下に調整すると自動で 5 分に戻ります。</li>
                <li>開始ボタン：<em>開始</em> → <em>一時停止</em> → <em>再開</em> と状態が切り替わり、初回開始時に +3 EXP を獲得します。</li>
                <li>リセットボタン：カウントダウンを停止し、設定した合計時間に戻します。</li>
            </ul>
            <p>
                計測が 0 になると「完了」ステータスに変わり、入力欄が再び有効になります。
                完了までに設定した分数に応じて EXP を獲得します（最大 +60 EXP）。
            </p>
        </section>

        <section>
            <h2>ストップウォッチモード</h2>
            <p>
                モードトグルで <strong>ストップウォッチ</strong> を選択すると、入力欄とクイック設定は非表示になります。
                メイン表示には分・秒（1 時間以上は hh:mm:ss）のメインタイムと、百分の 1 秒単位のサブ表示が更新されます。
            </p>
            <ul>
                <li>開始ボタン：初回開始時に +2 EXP を獲得します。</li>
                <li>一時停止ボタン：経過時間を保持したまま停止します。</li>
                <li>リセットボタン：経過時間と EXP 進捗（分経過ボーナス）をリセットします。</li>
            </ul>
            <p>
                計測中は 1 分経過するたびに +2 EXP を獲得します。EXP を受け取れなかった場合でも、経過分数の通知がステータスに表示されます。
            </p>
        </section>

        <section>
            <h2>ステータス表示</h2>
            <p>
                メインタイマーの下に現在の状態が表示されます。カウントダウン・ストップウォッチそれぞれで「準備完了」「計測中」「一時停止中」「再開しました」などのメッセージが切り替わり、ストップウォッチでは分経過の知らせも表示します。
            </p>
        </section>

        <section>
            <h2>EXP バッジとログ</h2>
            <ul>
                <li>画面右上のバッジに今セッションで獲得した EXP の合計値が表示されます。</li>
                <li>EXP を獲得した際には、履歴リストにタイムスタンプ付きの記録が追加されます（開始時・分経過時・完了時など）。</li>
                <li>EXP を獲得できなかった完了時には「タイマー完了！」というログが追加されます。</li>
                <li>履歴は最新 8 件まで保持され、最も古いものから自動的に削除されます。</li>
            </ul>
        </section>

        <section>
            <h2>実行と終了</h2>
            <ul>
                <li>ミニゲーム起動時に自動で計測処理が開始可能な状態になります。</li>
                <li>タブが非表示状態から復帰した際には現在時刻に合わせて表示を再計算します。</li>
                <li>ミニゲームを閉じるときは、内部でリスナーやアニメーションフレームが解除され、最新の設定が保存されます。</li>
            </ul>
        </section>
    </main>
</body>
</html>
