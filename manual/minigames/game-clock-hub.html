<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ミニゲーム: 時計ハブ</title>
    <link rel="stylesheet" href="../manual.css">
</head>
<body>
    <main>
        <h1>ミニゲーム: 時計ハブ</h1>
        <p>
            「時計ハブ」は、リアルタイムの時刻情報を多角的に確認できるユーティリティモジュールです。
            デジタル／アナログ表示の切り替えに加え、暦情報・進捗率・次の節目までの残り時間などをまとめて確認できます。
            秒や分など時間の節目に到達するたびに EXP が自動的に付与されるため、放置収集やダンジョン探索の合間にも活用できます。
        </p>

        <section>
            <h2>基本レイアウト</h2>
            <ul>
                <li><strong>タブ</strong>: 「デジタル」「アナログ」「詳細」の 3 種類。クリックで表示を切り替えます。</li>
                <li><strong>ヘッダー</strong>: モジュール名、説明文、現在のセッションで獲得した EXP の合計を表示します。</li>
                <li><strong>獲得 EXP バッジ</strong>: セッション開始後に加算された経験値をリアルタイム表示します。</li>
            </ul>
        </section>

        <section>
            <h2>タブ別の機能</h2>
            <article>
                <h3>デジタルタブ</h3>
                <ul>
                    <li>年月日と曜日を大きなフォントで表示します。</li>
                    <li>時刻は <strong>24 時間制／12 時間制</strong>をラジオボタンで切り替え可能です。設定はローカルストレージ <code>clock_hub_prefs_v1</code> に保存され、次回起動時も復元されます。</li>
                    <li>12 時間制では「午前／午後」のラベルが付きます。</li>
                </ul>
            </article>
            <article>
                <h3>アナログタブ</h3>
                <ul>
                    <li>キャンバス上に描画されたアナログ時計を表示します。</li>
                    <li><strong>通常（12 時間制）</strong>と<strong>24 時間制</strong>の 2 種を切り替え可能で、時針／分針／秒針はそれぞれ別色で描画されます。</li>
                    <li>切り替え設定はローカルストレージに保存され、再訪時にも維持されます。</li>
                </ul>
            </article>
            <article>
                <h3>詳細タブ</h3>
                <p>サブタブを用いて、暦・統計・残り時間などの情報を整理して表示します。最後に開いていたサブタブは設定として記録されます。</p>
                <dl>
                    <dt>概要</dt>
                    <dd>西暦・和暦・干支・皇紀・季節・二十四節気・うるう年判定をまとめて表示します。</dd>
                    <dt>進捗</dt>
                    <dd>秒・分・時・日・月・年・年代・世紀・千年紀の進行度をゲージと百分率で表示します。</dd>
                    <dt>残り時間</dt>
                    <dd>次の秒／分／時／日／月／年までの残り時間を、「あと◯分◯秒（±ミリ秒）」形式で表示します。</dd>
                    <dt>情報一覧</dt>
                    <dd>UNIX 時間、経過ミリ秒、ISO 8601 形式、年内通算日、今日経過秒、タイムゾーン、ロケールを確認できます。</dd>
                    <dt>カレンダー</dt>
                    <dd>
                        月次カレンダーを表示し、日付を選択すると和暦・干支・季節・週番号などの詳細を表示します。
                        独自の休暇日／出勤日を登録・削除でき、週末は自動的に休暇日としてハイライトされます（出勤日登録で上書き可能）。
                    </dd>
                </dl>
                <p class="small-note">カレンダーのカスタム休暇・出勤日は日付キー（YYYY-MM-DD）として保存され、カレンダー表示にも反映されます。</p>
            </article>
        </section>

        <section>
            <h2>EXP の獲得タイミング</h2>
            <p>内部タイマーは 50ms ごとに時刻を確認し、各単位が変わった瞬間に EXP を付与します。付与量は次のとおりです。</p>
            <table>
                <thead>
                    <tr>
                        <th>時間の節目</th>
                        <th>獲得 EXP</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>秒</td><td>+0.5</td></tr>
                    <tr><td>分</td><td>+50</td></tr>
                    <tr><td>時</td><td>+980</td></tr>
                    <tr><td>日</td><td>+7,690</td></tr>
                    <tr><td>月</td><td>+32,768</td></tr>
                    <tr><td>年</td><td>+260,000</td></tr>
                    <tr><td>世紀</td><td>+10,000,000</td></tr>
                    <tr><td>千年紀</td><td>+100,000,000</td></tr>
                </tbody>
            </table>
            <p>
                付与処理は <code>awardXp</code> コールバックを通じて行われ、付与済み EXP はヘッダーのバッジに合算表示されます。
                同じ節目が連続で変化しない場合は追加付与されません。
            </p>
        </section>

        <section>
            <h2>保存される設定</h2>
            <p>次の情報がローカルストレージ（キー: <code>clock_hub_prefs_v1</code>）に JSON 形式で保存されます。</p>
            <ul>
                <li>デジタル表示の 12h/24h 設定</li>
                <li>アナログ表示の 12h/24h 設定</li>
                <li>直前に開いていた詳細サブタブ</li>
                <li>カレンダーのカスタム休暇日／出勤日リスト</li>
            </ul>
            <p>登録されていない場合は 24 時間制デジタル、12 時間制アナログ、詳細サブタブ「概要」、休暇・出勤の空リストが初期値として使用されます。</p>
        </section>

        <section>
            <h2>小技・活用メモ</h2>
            <ul>
                <li>ローカライズ API と連携しているため、ゲーム内言語を切り替えると表示テキストや曜日表記が自動更新されます。</li>
                <li>独自の祝日を登録するとカレンダーのセル背景色が変わり、休暇日を視覚的に把握できます。</li>
                <li>カレンダーは常に 6 週表示で構成され、前月末・翌月初も一目で確認できます。セルをクリックすると選択状態が維持され、詳細パネルが更新されます。</li>
                <li>EXP の累積を重視する場合は、長時間起動して節目を連続で通過させると効率的です。特に日付変更や年越しなどの大きな節目で多くの EXP を獲得できます。</li>
            </ul>
        </section>
    </main>
</body>
</html>
