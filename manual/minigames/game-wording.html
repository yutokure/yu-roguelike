<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ミニゲーム: ワーディングツール</title>
    <link rel="stylesheet" href="../manual.css">
</head>
<body>
    <main>
        <h1>ミニゲーム: ワーディングツール</h1>

        <section>
            <h2>概要</h2>
            <p>
                <strong>Wording</strong> は MiniExp MOD に追加されるリッチテキスト・ワープロです。
                Office 風のタイトルバーとリボン UI を備え、本文編集・書式設定・挿入・保存といった操作に応じて EXP が得られます。
                タブレット調のページビュー、カラーテーマ、検索と置換、コメントや長文ハイライトといった文書作成の補助機能も実装されています。
            </p>
        </section>

        <section>
            <h2>起動とドキュメント管理</h2>
            <ol>
                <li>ミニゲーム選択画面で <strong>Wording</strong> を実行すると、初回に +8 XP の起動ボーナスが入ります。</li>
                <li>タイトルバー左側で現在の文書名が表示され、未保存の編集がある間は末尾に <code>*</code> が付与されます。</li>
                <li>「名前の変更」ボタンから任意のタイトルに変更できます。閉じるボタン（×）や「新規作成」を選んだ際は未保存の場合のみ確認ダイアログが表示されます。</li>
                <li>上書き保存（Ctrl+S）または名前を付けて保存（Ctrl+Shift+S）を実行すると <code>*.wording.html</code> 形式の HTML ファイルをダウンロードします。</li>
                <li>ファイルを開く（Ctrl+O）では <code>.html</code> / <code>.htm</code> / <code>.txt</code> / <code>.rtf</code> / <code>.wording</code> が取り込め、テキストはそのまま本文へ流し込まれます。</li>
                <li>「新規作成」（Ctrl+N）は保存済みか確認した上で、ローカライズされたテンプレート文と連番タイトル（例: 文書123）でリセットします。</li>
            </ol>
            <p class="small-note">編集内容・ズーム・テーマなどはローカルストレージ <code>miniexp_wording_v1</code> に自動保存され、次回起動時に復元されます。</p>
        </section>

        <section>
            <h2>画面構成</h2>
            <h3>タイトルバーとクイックアクセス</h3>
            <ul>
                <li>タイトルバー右側には最小化・最大化・閉じるのウィンドウボタンを模した操作があります。閉じる時は未保存かをチェックします。</li>
                <li>クイックアクセスバーには「開く」「上書き保存」「名前を付けて保存」「元に戻す」「やり直し」「印刷（準備中）」のアイコンがあります。印刷は現時点でダイアログを開かず、情報トーストを表示します。</li>
            </ul>
            <h3>リボンタブ</h3>
            <p>タブは <strong>ホーム</strong> / <strong>挿入</strong> / <strong>レイアウト</strong> / <strong>校閲</strong> / <strong>表示</strong> の 5 種類です。タブ切り替えで該当グループがグリッド表示されます。</p>
            <h3>ページビューとステータスバー</h3>
            <ul>
                <li>編集領域はページカード風に描画され、カラム数や背景色を切り替えられます。スクロール位置に応じてルーラーの透過が変化します。</li>
                <li>下部のステータスバーにはページ数・文字数・単語数とズーム倍率を表示します。ズームイン／アウトボタンで 50〜200% の範囲を 10% 刻みで変更できます。</li>
                <li>ステータスバーとルーラーは表示タブからそれぞれ個別に表示／非表示を切り替えられます。</li>
            </ul>
        </section>

        <section>
            <h2>ホームタブ</h2>
            <ul>
                <li><strong>クリップボード</strong>：貼り付け（XP +2／挿入扱い）、コピー、切り取り（XP +1）。</li>
                <li><strong>フォント</strong>：太字・斜体・下線・取り消し線・上付き・下付き、フォントファミリ（游ゴシック／游明朝／メイリオ／ヒラギノ角ゴ／等幅）と 8〜72pt のサイズ、文字色／蛍光ペン色を設定できます。</li>
                <li><strong>段落</strong>：箇条書き／番号付きリスト、左寄せ〜両端揃え、インデント増減を用意しています。</li>
                <li><strong>スタイル</strong>：本文（段落）、見出し 1・2、引用ブロックをワンクリックで適用します。</li>
            </ul>
        </section>

        <section>
            <h2>挿入・レイアウト・校閲・表示タブ</h2>
            <h3>挿入</h3>
            <ul>
                <li>日付・時刻・横罫線・スタンプ絵文字・目次テンプレートをワンクリックで挿入します（各操作で XP +3）。</li>
                <li>メディアグループではローカル画像の読み込みと、枠付きテキストボックスの追加（XP +4）が可能です。</li>
            </ul>
            <h3>レイアウト</h3>
            <ul>
                <li>テーマでライト／ダーク紙を切り替え、対応する文字色と背景が反映されます。</li>
                <li>列は 1〜3 カラムを選択でき、ページ余白は狭い・標準・広いの 3 プリセットが用意されています。</li>
            </ul>
            <h3>校閲</h3>
            <ul>
                <li>文字数カウントは文字数・単語数・段落数をトースト表示します。</li>
                <li>読了目安は 400 wpm を基準に分秒換算で提示します。本文が空の場合は警告トーストになります。</li>
                <li>「長文検出」は 80 文字以上の段落やリスト項目を淡色でハイライトし、再度押すと解除します。</li>
                <li>コメント挿入はポップアップ入力したメモを吹き出し風スタイルで本文に挿入します。変更サマリは保存済み本文との差分文字数を概算で表示します。</li>
            </ul>
            <h3>表示</h3>
            <ul>
                <li>行間は 1.2 倍・1.5 倍・2.0 倍を切り替えられます。</li>
                <li>ガイドグループでルーラー／ステータスバーの表示状態をトグルします。</li>
                <li>紙の色はホワイト／クリーム／グレーを選択でき、テーマ（ライト／ダーク）と組み合わせた配色に調整されます。</li>
            </ul>
        </section>

        <section>
            <h2>検索と置換</h2>
            <p>
                Ctrl+F または Ctrl+H で半透明の検索パネルが開きます。次を検索・置換・すべて置換・閉じるの 4 ボタンがあり、結果数と現在位置が表示されます。
                置換処理では選択範囲を差し替えたあとも検索結果を再構築して継続できます。
            </p>
        </section>

        <section>
            <h2>キーボードショートカット</h2>
            <table>
                <thead>
                    <tr>
                        <th>操作</th>
                        <th>ショートカット</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>上書き保存</td><td>Ctrl+S</td></tr>
                    <tr><td>名前を付けて保存</td><td>Ctrl+Shift+S</td></tr>
                    <tr><td>開く</td><td>Ctrl+O</td></tr>
                    <tr><td>新規作成</td><td>Ctrl+N</td></tr>
                    <tr><td>検索／置換パネル</td><td>Ctrl+F、Ctrl+H</td></tr>
                    <tr><td>印刷（準備中メッセージ）</td><td>Ctrl+P</td></tr>
                    <tr><td>元に戻す／やり直す</td><td>Ctrl+Z / Ctrl+Y</td></tr>
                    <tr><td>太字／斜体／下線</td><td>Ctrl+B / Ctrl+I / Ctrl+U</td></tr>
                    <tr><td>左揃え／中央揃え／右揃え／両端揃え</td><td>Ctrl+L / Ctrl+E / Ctrl+R / Ctrl+J</td></tr>
                    <tr><td>見出しレベル適用</td><td>Ctrl+Alt+1（H1）、Ctrl+Alt+2（H2）</td></tr>
                </tbody>
            </table>
        </section>

        <section>
            <h2>経験値とスコア</h2>
            <ul>
                <li>起動時に +8 XP。</li>
                <li>本文の入力は 0.8 秒間隔で +1 XP。</li>
                <li>書式設定（フォント・段落・テーマ・行間など）は 0.3 秒間隔で +2 XP。</li>
                <li>挿入操作（画像やテキストボックスなど）は 0.4 秒間隔で +3〜4 XP。</li>
                <li>保存すると +6 XP。トーストで成功通知が表示され、タイトルの <code>*</code> が消えます。</li>
                <li>セッションで得た XP の合計が最終スコアになります。</li>
            </ul>
            <p class="small-note">印刷ボタンは現状モック機能ですが、操作すると挿入扱いで経験値が入ります。</p>
        </section>

        <section>
            <h2>データ保持の仕組み</h2>
            <p>
                編集内容は 600ms ごとにローカルストレージへ書き出されます。保存項目は文書名・本文 HTML・ズーム倍率・テーマ（ライト／ダーク）・カラム数・行間・紙色・ルーラー／ステータスバーの表示状態です。
                リボンの設定変更や検索ダイアログの開閉も即座にセッションへ反映され、終了時に <code>Destroy</code> しても情報が保持されます。
            </p>
        </section>
    </main>
</body>
</html>
