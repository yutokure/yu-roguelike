<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ミニゲーム: 石盤ボードゲーム集</title>
    <link rel="stylesheet" href="../manual.css">
</head>
<body>
    <main>
        <h1>ミニゲーム: 石盤ボードゲーム集</h1>
        <section>
            <h2>概要</h2>
            <p>
                石盤ボードゲーム集は 15×15 の盤面を使ったラインメイクゲーム（コネクトシックス、五目並べ、連珠）と、
                ドロップ式の四目並べ、三目並べをまとめたモジュールです。ロビーで選択したバリエーションと難易度が
                そのまま反映され、MiniExp の EXP もプレイ内容に応じて付与されます。連珠では禁手ルールが実装されており、
                実際の段位戦に近い感覚でプレイできます。
            </p>
        </section>
        <section>
            <h2>収録バリエーション</h2>
            <ul>
                <li><strong>コネクトシックス</strong>：6 連を作る五目並べ派生。通常の交互置きで先手番はプレイヤーです。</li>
                <li><strong>五目並べ</strong>：禁手なしの標準ルール。</li>
                <li><strong>連珠</strong>：プレイヤー（黒石）のみ禁手が適用され、長連・四々・三々を防ぎながら 5 連を目指します。</li>
                <li><strong>四目並べ</strong>：コマが最下段まで落下する 7×6 盤。列を選択して駒を投下します。</li>
                <li><strong>三目並べ</strong>：3×3 のクラシックな Tic Tac Toe。ハードでは完全読みによる引き分け志向 AI が出現します。</li>
            </ul>
        </section>
        <section>
            <h2>画面構成</h2>
            <ul>
                <li><strong>盤面キャンバス</strong>：中央に配置され、マス目の大きさはバリエーションに応じて自動調整されます。プレイヤー石は濃紺、AI 石は淡色で描画され、直前の着手には黄色の輪が表示されます。<span class="small-note">連珠・五目系は木目調の背景、四目並べは青いボードが描かれます。</span></li>
                <li><strong>ステータスラベル</strong>：盤面左上に現在の手番が表示され、終了時は結果メッセージと「R キーでリセットできます」という案内がオーバーレイされます。</li>
                <li><strong>脅威ハイライト</strong>：AI・プレイヤー双方の必至や追い筋が検出されると、該当セルが赤／オレンジのパルスで囲まれ、必要に応じてラインも引かれます。新しい脅威が発生した場合は吹き出しで「詰み手」「追われ手」などのラベルが表示されます。</li>
                <li><strong>連珠禁手アラート</strong>：禁手に該当するマスをクリックすると、そのマスがオレンジ色の破線でハイライトされ、「禁手: 長連」「禁手: 四々」などの吹き出しが 1.5 秒間表示されます。</li>
            </ul>
        </section>
        <section>
            <h2>基本操作</h2>
            <ul>
                <li>マウスクリックで石を配置します。四目並べのみ列全体がハイライトされ、クリックすると最下段の空きマスに自動で落下します。</li>
                <li>マウスカーソルを空きマスに乗せると淡い黄色のサークルで候補位置が示されます。既に石があるマスや禁手に該当するマスではハイライトが出ません。</li>
                <li>ゲーム中に <kbd>R</kbd> キーを押すと盤面がリセットされます。終了後も同じ操作で再戦できます。</li>
            </ul>
        </section>
        <section>
            <h2>ゲームの流れ</h2>
            <ol>
                <li>初期状態ではプレイヤーが先手で、空きマスをクリックして石を置きます。連珠の場合は禁手判定が通過した手のみが確定します。</li>
                <li>石を置くと即座に AI の応手が計算されます。難易度ノーマル以上ではこちらの必勝手を優先的にブロックします。</li>
                <li>いずれかが勝利条件の連数を揃えるとゲーム終了です。全マスが埋まった場合は引き分けになります。</li>
                <li>勝敗結果に応じた EXP が加算され、<kbd>R</kbd> キーまたはロビー側のリスタート操作で新しい対局を始められます。</li>
            </ol>
        </section>
        <section>
            <h2>連珠の禁手ルール</h2>
            <ul>
                <li>禁手判定はプレイヤー（黒石）のみ対象です。AI（白石）は通常の五目並べと同様に打石できます。</li>
                <li>以下の 3 パターンを同時に満たす着手は禁手として拒否されます。
                    <ul>
                        <li><strong>長連</strong>：6 連以上が一直線にできてしまう手。</li>
                        <li><strong>四々</strong>：開き四（両側が空いた四連）が 2 箇所以上同時に成立する手。</li>
                        <li><strong>三々</strong>：開き三（両端が空いた三連）が 2 箇所以上同時に成立する手。</li>
                    </ul>
                </li>
                <li>禁手をクリックするとハイライトと吹き出しで理由が示され、石は配置されません。別の合法手を選択してください。</li>
            </ul>
        </section>
        <section>
            <h2>AI と難易度</h2>
            <ul>
                <li><strong>EASY</strong>：ランダム性の高い着手で、連珠でも基本的な防御をほとんど行いません。</li>
                <li><strong>NORMAL</strong>：勝ち筋の即応、こちらのリーチのブロック、中央寄りの着手を優先する評価関数でプレイします。</li>
                <li><strong>HARD</strong>：評価関数に加えて分岐読みを行い、こちらの二手勝ちやフォークを事前に消す動きを取ります。三目並べのみミニマックスで完全解が採用されます。</li>
            </ul>
            <p class="small-note">難易度によって勝利時の EXP ボーナスが変化します（連珠: EASY 32 / NORMAL 130 / HARD 300）。</p>
        </section>
        <section>
            <h2>EXP とプレイ評価</h2>
            <ul>
                <li>石を置くたびに <strong>+1 EXP</strong> を獲得します。</li>
                <li>勝利手以外でリーチ（あと 1 手で勝利できる形）を作った場合は追加で <strong>+10 EXP</strong> が入ります。</li>
                <li>勝利すると難易度ごとのボーナスが付与されます。連珠以外の派生ゲームも、それぞれの設定値が適用されます。</li>
            </ul>
        </section>
        <section>
            <h2>戦略とヒント</h2>
            <ul>
                <li>連珠では早い段階で星（天元付近）や肩星を押さえておくと、禁手に引っ掛からずに五連を作りやすくなります。</li>
                <li>脅威ハイライトは AI の詰めろも表示するので、赤いパルスが出たラインを優先的に確認し、防手を打ちましょう。</li>
                <li>三々を意図的に狙うと禁手になるため、開き三は一方の延長を塞ぎながら別ラインでリーチを作る形が安全です。</li>
            </ul>
        </section>
    </main>
</body>
</html>
