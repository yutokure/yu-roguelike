<html>

<head>
	<meta http-equiv="Content-Language" content="ja">
			<meta http-equiv="Content-Type" content="text/html; charset=shift_jis">
	<link rel="stylesheet" type="text/css" href="../../style.css">
	<title>HTTPでホームページの内容を調べる</title>
</head>

<body>

<div id="header">
	<div class="title">
		HTTPでホームページの内容を調べる</div>
	<div class="sub">
		TTSneoマニュアル</div>
	<div class="navi">
		<a target="_parent" href="../../index.html">マニュアル</a> &gt; <a target="_parent" href="../index.htm">機能編</a> &gt; <a target="contents" href="menu-net.htm">インターネット</a> &gt;</div>
	<div class="date">
		<!--webbot bot="Timestamp" s-type="EDITED" s-format="%Y/%m/%d" startspan -->2007/03/18<!--webbot bot="Timestamp" endspan i-checksum="12507" -->更新</div>
</div>
<h2>ホームページの内容を調べるには</h2>
<blockquote>
	<p class="tomo">とも　「今インターネットを使って、ホームページの情報を表示するソフトを作っているんだけど、ホームページの情報を、変数に入れることはできる？」</p>
	<p class="neo">ねお　「「ＨＴＴＰでダウンロード」関数を使えばできます。<br>
	この関数を使えば、指定したアドレスの内容(HTMLソースなど)を変数に入れることができます。」</p>
	<p class="tomo">とも　「そんな便利な関数があるんだぁ。」</p>
	<p class="neo">ねお　「下の例では、読売新聞社のホームページの内容を取得します。」</p>
	<p class="example">内容は　ＨＴＴＰでダウンロード（「http://www.yomiuri.co.jp/」）</span></p>
	<p>「ＨＴＴＰでダウンロード」関数使うと、アドレスにアクセスしてそのページにある情報をダウンロードして、「内容」変数に保存します。</p>
	<p class="tomo">　</p>
	<p class="tomo">とも　「この関数を実行すると、「内容」にホームページの内容が保存されるから、基本編で習った文字の操作を使って、表示したい内容だけを取り出すことができるんだね」</p>
	<p class="neo">ねお　「その通り。最新のニュースや天気予報などから自分の必要な情報だけを取り出して表示したり、お気に入りのサイトの更新を確認したりするといったことも、出来ます。」</p>
	<p class="tomo">とも　「そっか！！　いろいろなことができるかも」</p>
	<p class="neo">ねお　「でも、ほんの少しHTMLの知識も必要かもね」 </p>
	<p class="tomo">とも　「でも、「ソースの表示」で、適当に探せばできるかも・・・」</p>
	<p>　</p>
</blockquote>
<h2>エンコード(文字コード)を指定する</h2>
<blockquote>
	<p class="tomo">とも　「同じようにして、Yahoo!のホームページを調べようとしたんだけど、内容が文字化けして見られないんだけど、どうして？」</p>
	<p class="neo">ねお　「ホームページの文字コードが違うからです。」</p>
	<p class="tomo">とも　「文字コード？？」</p>
	<p class="neo">ねお　「インターネットにはWindows以外にもいろいろなソフトを使っているコンピュータがつながっているから、文字化けすることがあります。」</p>
	<p class="tomo">とも　「なるほどぉ・・・　どうすればいいの？」</p>
	<p class="neo">ねお　「HTTPでダウンロード関数に、文字コードを指定します。」</p>
	<p class="format">内容は　ＨＴＴＰでダウンロード（[アドレス]、[文字コード]）</span></p>
	<p>文字コードには、SJIS/EUCが指定できます。<br>
	文字コードを省略するとHTMLの内容を調べて、適切な文字コードを選びます。</p>
	<p class="neo">ねお　「Yahoo!のホームページの場合は、EUCだから、これを使って下のようにすればうまくいきます。」</p>
	<p class="example">内容は、ＨＴＴＰでダウンロード（「http://www.yahoo.co.jp/」、EUC）</p>
	<p class="tomo">とも　「いちいち、文字コードを指定しないといけないのは面倒だね」</p>
	<p class="neo">ねお　「ほとんどの場合は、自動的に判断してくれるから安心してください。」</p>
	<p>　</p>
</blockquote>
<h2>画像ファイルなどをダウンロードする</h2>
<blockquote>
	<p class="tomo">とも　「ホームページの内容は、取得できたけど、画像やプログラムファイルなどをダウンロードするにはどうするの？」</p>
	<p class="neo">ねお　「「ＨＴＴＰでダウンロード」関数で取得できるのは、テキストファイルのみですので、画像や音楽と言ったデータは、「ダウンロード」命令を使います。」</span></p>
	<p></p>
	<p class="example">「http://hp.vector.co.jp/authors/VA021321/ttsbanr.png」</span> を「［デスクトップフォルダ］ttsbanr.png」</span>にダウンロード </span></p>
	<p></p>
	<p class="tomo">とも　「ほんとだ、TTSneoのバナーがダウンロードされている」</p>
	<p class="neo">ねお　「これでインターネット上の画像ファイルをダウンロードすることができます。」</span></p>
</blockquote>
<p>　</p>
<h4>著作権について</h4>
<blockquote>
	<p>自分のパソコンで使う分には問題ありませんが、インターネット上にある画像や音楽などには、著作権があります。<br>
	自分のソフトに、ネット上の特定の画像や音楽を使うように組み込んで、無許可で公開すると、著作権の侵害になることがありますので、注意しましょう。</p>
</blockquote>
<p>　</p>
<h2>POST送信する</h2>
<blockquote>
	<p class="neo">ねお　「「HTTPでダウンロード」関数は、CGIやASPを利用してフォームの情報を送るように、POST形式でデータを送信することができます。」</p>
	<p class="format">ＨＴＴＰでダウンロード（[アドレス]、[文字コード]、[POSTデータ]）</span></p>
	<p>[POSTデータ]に、必要なデータを指定します。</p>
	<p><b>例</b>　TitleとNameを送信する</p>
	<p class="example">内容は　ＨＴＴＰでダウンロード（「http://www.xxx.xxx/post.cgi」、「」、「title=abc&amp;name=123」）</span></p>
</blockquote>
<p>　</p>
<h2>URL形式を使う</h2>
<blockquote>
	<p>インターネットのアドレスには、通常全角文字を使うことができません。<br>
	たとえば、Yahoo!で「日本語」と検索すると</p>
	<p>http://search.yahoo.co.jp/bin/search?p=%C6%FC%CB%DC%B8%EC&amp;src=top</p>
	<p>というようになります。</p>
	<p>この　「%C6%FC%CB%DC%B8%EC」の部分をURL形式(URLエンコード)と言っています。</p>
	<p>多くの場合、GET形式でアドレスを指定する場合、そのまま漢字を指定すると、自動的に変換を行ってくれる場合がありますが、文字コード形式が異なる場合、正しく文字が送信されないことがあります。</p>
	<p>TTSneoでは、「URL形式」関数を使うことで、全角文字をURLエンコードすることができます。</p>
	<p class="format">ＵＲＬ形式（[文字]、[文字コード(省略可能)]）</p>
	<p>[文字]には、変換したい文字を指定します。</p>
	<p>[文字コード]には、変換したい文字の文字コードを指定します。<br>
	EUC/JIS/Shift-JIS/UTF8　が指定できます。</p>
	<p>　</p>
	<p>　</p>
</blockquote>

</body>

</html>
