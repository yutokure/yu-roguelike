<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ミニゲーム: 3Dグラフィックテスター</title>
    <link rel="stylesheet" href="../manual.css">
</head>
<body>
    <main>
        <h1>ミニゲーム: 3Dグラフィックテスター</h1>

        <section>
            <h2>概要</h2>
            <p>
                「3Dグラフィックテスター」は、MiniExp MOD に同梱されている WebGL2 ベースの 3D デモ集です。
                オブジェクト配置ラボ、レイトレーシング風レンダリング、技術ギャラリーの 3 モードに加え、GPU 情報の表示や簡易ベンチマークを備えています。
                ブラウザ単体で動作するよう外部依存はなく、<code>file://</code> スキームでも利用できます。
            </p>
        </section>

        <section>
            <h2>起動条件と互換性</h2>
            <ul>
                <li>WebGL2 に対応したブラウザと GPU が必須です。初期化に失敗した場合はヘッダーに警告と代替メッセージが表示されます。</li>
                <li>互換性チェックでは、GPU ベンダー名・レンダラー名・GL/GLSL バージョン・テクスチャサイズ上限などの情報が取得され、ヘッダー右側の情報欄に一覧表示されます。</li>
                <li>WebGL2 が無効の場合でもページは読み込まれますが、描画領域は利用できず操作ボタンも機能しません。ブラウザの設定で WebGL2 を有効化してください。</li>
            </ul>
        </section>

        <section>
            <h2>画面構成</h2>
            <ul>
                <li><strong>ヘッダー</strong>: モジュールタイトルと「WebGL2」「Ray Marching」「Benchmark」のバッジ、および GPU 情報ブロックを表示します。</li>
                <li><strong>メイン領域</strong>: 左側に操作パネル、右側に描画キャンバスが並ぶ 2 カラム構成です。キャンバス上には FPS とデモ固有統計がオーバーレイ表示されます。</li>
                <li><strong>ログパネル</strong>: 画面下部のログビューに操作結果やエラー、ベンチマーク結果が時刻付きで追記されます。</li>
            </ul>
        </section>

        <section>
            <h2>基本操作</h2>
            <h3>カメラ操作</h3>
            <ul>
                <li>キャンバス上でドラッグすると軌道カメラの角度（θ/φ）を回転できます。</li>
                <li>ホイール操作でズーム距離を調整します（最小 4 〜 最大 40 ユニット）。</li>
                <li>オブジェクトラボと技術ギャラリーの両モードで共通のカメラ挙動が適用されます。</li>
            </ul>
            <h3>デモ切り替え</h3>
            <p>
                操作パネル上部のセレクタからデモを選択します。切り替え時にはログに切り替え履歴が記録され、選択中のモードに合わせて下部の操作 UI が入れ替わります。
            </p>
        </section>

        <section>
            <h2>各デモの詳細</h2>
            <h3>オブジェクトラボ</h3>
            <ul>
                <li>初期状態でキューブ・スフィア・シリンダーが 6 体ずつ配置され、自動回転が有効になっています。</li>
                <li>「キューブ追加」「スフィア追加」「シリンダー追加」ボタンでランダムな位置・回転・スケール・色のメッシュを追加できます。</li>
                <li>「全削除」で配置をリセットし、デフォルトシーンを再生成します。</li>
                <li>オート回転チップで回転処理のオン/オフを切り替えられます。状態変更はログにも記録されます。</li>
                <li>ベンチマーク実行中は毎フレーム最大 8 個のキューブが自動追加され、6 秒後に平均 FPS と描画オブジェクト数がレポートされます。</li>
            </ul>
            <h3>レイトレーシング風デモ</h3>
            <ul>
                <li>フルスクリーンクアッドを用いたレイマーチングのシェーダデモです。</li>
                <li>「反射回数」スライダーで 1 〜 6 の整数バウンス数を指定できます。</li>
                <li>「露光」スライダーで 0.4 〜 2.2 の範囲を 0.1 刻みで調整し、発光量の感度を変更します。</li>
            </ul>
            <h3>技術ギャラリー</h3>
            <ul>
                <li>ライト付きの立方体・球体・シリンダーを組み合わせ、リング状インスタンシングや動的モーションブラー風エフェクトを可視化します。</li>
                <li>モーション軌跡は 24 セグメントで保持され、時間経過に応じてフェードアウトします。</li>
                <li>別途の設定項目はなく、カメラ操作で視点を動かしながら演出を観察します。</li>
            </ul>
        </section>

        <section>
            <h2>ベンチマークの利用方法</h2>
            <ol>
                <li>操作パネル下部の「6秒間ベンチマーク開始」ボタンを押します（自動的にオブジェクトラボへ切り替わります）。</li>
                <li>処理が始まるとログに開始メッセージが追加され、6 秒間で大量のキューブが追加生成されます。</li>
                <li>終了時には平均 FPS と最終的なオブジェクト数がログへ出力されます。MiniExp 連携時は FPS 値に応じた経験値ボーナスが付与されます。</li>
            </ol>
        </section>

        <section>
            <h2>オーバーレイとログの読み方</h2>
            <ul>
                <li>オーバーレイの 1 行目は現在の FPS（小数第 1 位）です。</li>
                <li>2 行目はモードに応じた統計を表示します。オブジェクトラボでは配置オブジェクト数、レイマーチングでは反射回数、ギャラリーでは固定テキストです。</li>
                <li>ログパネルは <code>[時刻] メッセージ</code> 形式で追記されます。スクロールは自動で最新行に追従します。</li>
            </ul>
        </section>

        <section>
            <h2>トラブルシューティング</h2>
            <ul>
                <li>WebGL2 初期化に失敗する場合は、ブラウザの WebGL 設定または GPU ドライバを確認し、対応ブラウザで再試行してください。</li>
                <li>極端に低い FPS が出る場合は、オート回転を停止し、オブジェクト数を減らすか、レイトレーシング風モードで反射回数と露光を抑えてください。</li>
                <li>リサイズ時に描画が崩れた場合は、ウィンドウサイズを戻すかモジュールを再読み込みし、必要ならベンチマークを再走行して GPU 負荷を再確認します。</li>
            </ul>
        </section>
    </main>
</body>
</html>
