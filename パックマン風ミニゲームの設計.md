# パックマン風ミニゲームの設計

本設計は「ミニゲームAPI書（MiniExp MOD API v0.1）」準拠。迷路内の餌（ドット）をすべて食べるとクリア。餌取得と全取得でEXPを付与します。

- ID: `pacman`
- 表示名: パックマン風
- エントリ: `games/pacman.js`
- バージョン: 0.1.0

## ルール/操作
- 矢印キー: 上下左右に移動（グリッドスナップ）。
- 餌（ペレット）: 通過で自動取得。
- パワー餌: ゴースト反転・一定時間無害化（任意実装。EXPは付与しない）。
- 接触: 有害時のゴーストに触れるとミス。残機0で終了。

## 難易度
- EASY: ゴースト2体、速度低、追跡緩い。残機3。
- NORMAL: ゴースト4体、速度中、通常の追跡。残機3。
- HARD: ゴースト4体、速度高、追跡強化/ランダム性低。残機2。

## EXP 仕様（必須要件の反映）
- 餌1つ取得: +0.5 EXP。
- すべての餌を食べ終える: +100 EXP。
- 付与タイミング: 取得フレームで `awardXp(0.5)`、全消化時に `awardXp(100)`。

## 記録/スコア
- `getScore()` = `pelletsEaten`（取得数）。全消化時は総数に一致。
- 迷路の総餌数は固定レイアウト基準で定義。

## UI/演出
- 上: 残機/取得数/残数。
- 取得時に小バッジ表示。全消化時は「STAGE CLEAR」演出後終了。

## 実装方針（API連携）
- `create(root, awardXp, { difficulty })`:
  - タイルマップ/経路テーブル構築、ゴースト簡易AI（ターゲットタイル追尾＋ランダム分岐）。
  - 餌に乗った瞬間 `awardXp(0.5,{type:'pellet'})`。全消化判定で `awardXp(100,{type:'clear'})`。
- `start/stop/destroy`: ループ/入力/可視性ハンドリング。

## エラー/ガード
- 迷路外座標の丸め、反転中の無敵判定。

## manifest.json 例
```json
{ "id": "pacman", "name": "パックマン風", "entry": "games/pacman.js", "version": "0.1.0", "description": "餌×0.5 / 全消化+100EXP", "category": "アクション" }
```
