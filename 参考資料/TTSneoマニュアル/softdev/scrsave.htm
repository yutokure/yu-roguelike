<html>

<head>
<meta http-equiv="Content-Language" content="ja">
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta http-equiv="Content-Type" content="text/html; charset=shift_jis">
<link rel="stylesheet" type="text/css" href="../style.css">
<title>スクリーンセーバーを作る</title>
</head>

<body>

<div id="header">
	<div class="title">
		１４．スクリーンセーバーを作る</div>
	<div class="sub">
		TTSneoマニュアル</div>
	<div class="navi">
		<a target="_parent" href="../index.html">マニュアル</a> &gt; <a target="_parent" href="index.htm">ソフト作り編</a> &gt;</div>
	<div class="date">
		<!--webbot bot="Timestamp" s-type="EDITED" s-format="%Y/%m/%d" startspan -->2005/02/12<!--webbot bot="Timestamp" endspan i-checksum="12415" -->更新</div>
</div>
<h2>スクリーンセーバーを作る</h2>
<table border="0" cellpadding="10" cellspacing="0" width="100%">
	<tr>
		<td><img border="0" src="../img/ttschar9.png" width="116" height="115"></td>
		<td>TTSneoでは、スクリーンセーバーも簡単に作ることができます。<p>
		スクリーンセーバー解除時のパスワード入力画面やプレビュー表示などは、プログラムをすることなく利用することができるので、とても簡単に実用的なスクリーンセーバーを作ることができます。</td>
	</tr>
</table>
<blockquote>
	<p class="neo">ねお　「そうそう、TTSneoでは、スクリーンセーバーを作ることができるんだよ」</p>
	<p class="tomo">とも　「それは面白そうだね」</p>
</blockquote>
<p>　</p>
<h2>スクリーンセーバーの作り方</h2>
<blockquote>
	<p class="neo">
	ねお　「スクリーンセーバーというのは、本当はブラウン管のディスプレイの画面やけを防ぐためのソフトです。最近は液晶が多いから、飾りに使う人が多いです。」</p>
	<p class="tomo">とも　「そうだったのかぁ」</p>
	<p class="neo">ねお　「だから、スクリーンセーバーには、決りがあるんだよ。こんな感じです。」</p>
	<p>・フルスクリーンを使って、常に同じものが表示されないようにする<br>
	・キーボートを押す、または、マウスでクリックしたら終了する<br>
	・設定画面を作る</p>
</blockquote>
<p>　</p>
<h2>新規作成でひな形を使う</h2>
<blockquote>
	<p class="neo">ねお　「では、作り方を説明するね<br>
	TTSneoデザイナのひな形を使えば、簡単にスクリーンセーバーの原型ができます。」</p>
	<p "&gt;とも　「新規作成でひな形が選択できるんだよね」&lt;/p&gt;
	&lt;p " class="tomo">とも　「新規作成を使えばできるよね」</p>
	<p "&gt;とも　「新規作成でひな形が選択できるんだよね」&lt;/p&gt;
	&lt;p " class="neo">ねお　「そう　「ファイル」メニューの「新規作成」を開いて、一覧から「スクリーンセーバー」を選んで[作成]してね」</p>
</blockquote>
<p "&gt;とも　「新規作成でひな形が選択できるんだよね」&lt;/p&gt;
	&lt;p ">　</p>
<p "&gt;スクリーンセーバー&lt;/p&gt;
	&lt;p&gt;次のようなプログラムが作られます。&lt;br&gt;
	これを修正していきます。 &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p class=" example" class="example"><span class="rem">ーータイトル：<br>
’作者　　：<br>
’作成日時：2005/02/12 11:38:47<br>
’開発言語：TTSneo 1.1.1434（2005/02/11 0:50:44）<br>
</span>タイトルは、「」<br>
<span class="rem">ーー★作成手順★<br>
’「初期化」手順と「描画処理」手順の中に、スクリーンセーバーの動きとなる<br>
’プログラムを作成してください。<br>
</span><br>
起動時設定は　「/S」<br>
もし　左（起動時設定，２）は　「」　または　「/c」　なら<br>
　　<span class="rem">ーー■設定画面</span><br>
　　「このスクリーンセーバーには設定はありません［改行］動作を見たいときはＴＴＳスタジオから実行してください」を情報で表示<br>
　　終了<br>
もし終わり<br>
<br>
初期化<br>
描画開始<br>
<br>
待機<br>
<br>
<span class="rem">ーー★手順はこれより下に書きます</span><br>
<br>
手順は　初期化<br>
<span class="rem">ーー■初期化</span><br>
　　フルスクリーン１を使う<br>
<br>
<span class="rem">ーーアイコンの読み込みや変数の設定は、ここに書きます<br>
’↓下のようにすると画面キャプチャできます<br>
’画面をフルスクリーン１へ画像コピー<br>
</span><br>
　　フルスクリーン１の表示<br>
終わり<br>
<br>
<span class="pink">手順は　描画開始<br>
’★動きをつけるプログラムを入力してください<br>
’通常は、「繰り返せ」命令を使います。<br>
終わり<br>
</span><br>
手順は　フルスクリーン１の表示<br>
フルスクリーン１を使う<br>
<span class="rem">ーーウィンドウの編集で自動処理されますので、<br>
’次のプログラムは、変更しないでください！<br>
’&lt;フルスクリーン１&gt;<br>
</span>フルスクリーン１の中の大きさを320，247へ変えろ<br>
　　その名前を「フルスクリーン１」へ変えろ<br>
　　その色を&amp;hFFFFFFへ変えろ<br>
　　その背景を&amp;h000000へ変えろ<br>
　　その最前面を1へ変えろ<br>
　　その初期状態を「中央」へ変えろ<br>
<span class="rem">ーー&lt;/フルスクリーン１&gt;<br>
’自分でプログラムを入れたいときは、必ずこれより下に入力してください<br>
</span>フルスクリーン１を表示<br>
終わり<br>
<br>
手順は　フルスクリーン１をクリック<br>
<span class="rem">ーー★終了処理</span><br>
　　閉じる<br>
　　終了<br>
終わり</p>
<blockquote>
	<p class="tomo">とも　「プログラムができてる〜」</p>
	<p class="neo">ねお　「このまま実行してみてください。」</p>
	<p class="tomo">とも　「ぎゃっ　画面が黒くなった！？　まさかパソコンがバグった？？」</p>
	<p class="neo">ねお　「そう、あせらないで(汗」</p>
	<p class="tomo">とも　「わかった！　まだ何もプログラムしていないから、何も表示されないんだね<br>
	でも、マウスポインタが表示されているね　これは消せないの？」</p>
	<p class="neo">
	ねお　「TTSneoデザイナ上で実行したときは、マウスカーソルは表示されるけど、実行ファイルにしちゃうとポインタは消えます、それに動かしただけで終了されます。」 
	</div>
	</p>
	<p class="tomo">とも　「なるほどなるほど、この後はどうするの？」</p>
	<p class="neo">
	ねお　「この状態でTTSneoデザイナneoの「ウィンドウの編集」ボタンを押すと、フルスクリーン１のウィンドウの編集画面が出ます。　ここに必要に応じてオブジェクトやプログラムを入力していってください。」</p>
	<p class="neo">　</p>
</blockquote>
<p>　</p>
<h2>設定画面を出したい！</h2>
<blockquote>
	<p class="neo">ねお　「次は、スクリーンセーバーの設定画面の作り方を説明するね」</p>
	<p>スクリーンセーバーの設定画面を使うときは、スクリーンセーバーのプログラムが入る前に次のプログラムを入力します。 </p>
</blockquote>
<p class="example">起動時設定は　「/S」<br>
もし　左（起動時設定，２）は　「」　または　「/c」　なら<br>
　　<span class="rem">ーー■設定画面</span><br>
　　「このスクリーンセーバーには設定はありません［改行］動作を見たいときはＴＴＳスタジオから実行してください」を情報で表示<br>
　　終了<br>
もし終わり</p>
<blockquote>
	<p class="neo">
	ねお　「このプログラムの「このスクリーンセーバーに設定はありません・・・」と書いてある部分に、設定画面を表示するプログラムを入れれば、設定画面が表示されます。」</p>
	<p class="tomo">とも　「なるほどね。ウィンドウの編集でウィンドウを追加すればいいんだね」</p>
	<p class="neo">ねお　「そう。ウィンドウを表示させる時は、「待機」命令を忘れないようにしましょう。」</p>
	<p class="neo">　</p>
</blockquote>
<h4>起動時設定を変更したい場合</h4>
<blockquote>
	<p class="tomo">とも　「でも、これだと、TTSneoデザイナで、設定画面が表示されないよ。」</p>
	<p class="neo">ねお　「TTSneoでスクリーンセーバーを作成中に、設定画面を出したいときは「起動時設定は」命令を使用します。」</p>
	<p class="example">起動時設定は　「/c」</p>
	<p class="neo">ねお　「このようにすれば、設定画面を表示するときと、実際の画面との処理の切り替えも可能です。」</p>
	<p>「起動時設定は」命令で指定した内容は、TTSneoデザイナ内でのみ有効です。</p>
</blockquote>
<p>　</p>
<h2>スクリーンセーバーの起動時設定（コマンドライン）</h2>
<blockquote>
	<p>Windowsスクリーンセーバーは、１つのファイルで「実際の画面」「設定画面」「プレビュー」「パスワード設定」の４つの機能があります。<br>
	TTSneoでは、「起動時設定」関数で、コマンドラインが取得できますので、スクリーンセーバーの状況に応じて、状態を変更することができます。</p>
</blockquote>
<table cellPadding="2" width="100%" border="1">
	<tr>
		<td class="items" noWrap align="middle">起動時設定</td>
		<td class="items" noWrap align="middle">意味</td>
		<td class="items" align="middle">説明</td>
	</tr>
	<tr>
		<td noWrap>/s</td>
		<td noWrap>スクリーンセーバーの実行</td>
		<td>スクリーンセーバーを実行します。<br>
		（サンプルの場合は、このコマンドラインの判断を省略しています）</td>
	</tr>
	<tr>
		<td noWrap>/c または　なし</td>
		<td noWrap>設定画面</td>
		<td>下のようにして、スクリーンセーバーの設定画面を表示できるようにしてください。 
		<p class="example">もし　小文字（起動時設定）は、「/c」　なら</td>
	</tr>
	<tr>
		<td noWrap>/p</td>
		<td noWrap>プレビュー表示</td>
		<td>下のようにして、プレビュー表示のときのスクリーンセーバーの状況を作成してください。通常は、「/s」の時と同じ動作でかまいません。<br>
		もしプレビュー表示のときに違った表示をさせたいときは、これで判断させてください。 
		<p class="example">もし　小文字（左（起動時設定、２））は、「/p」　なら</td>
	</tr>
	<tr>
		<td noWrap>/a</td>
		<td noWrap>パスワード設定画面</td>
		<td>これはTTSneoランタイムに組み込ませていますので、プログラムする必要はありません。<br>
		TTSプログラムが実行されずに終了するので、この場合の処理をすることはできません。</td>
	</tr>
</table>
<p>　</p>
<h2>スクリーンセーバーを完成させる</h2>
<blockquote>
	<p class="tomo">とも　「スクリーンセーバーも実行可能ファイルにできる？」</p>
	<p class="neo">
	ねお　「うん。スクリーンセーバーを作りたい場合は、「実行可能ファイルの作成」画面で、「ファイルの種類」を「スクリーンセーバー」に変えてください。」</p>
	<p>拡張子が「scr」になると自動的にスクリーンセーバーランタイムを利用して作成します。</p>
	<p>スクリーンセーバーは、標準版のみ提供されています。<br>
	このスクリーンセーバー版には、通常のランタイムモジュールのほかに、スクリーンセーバー用に下の機能があります。</p>
	<p>・プレビュー表示機能<br>
	・パスワード確認機能<br>
	・[Alt]+[Ctrl]+[Delete]防止機能<br>
	・マウスの操作によって終了する機能</p>
	<p>以上の機能については、実行可能ファイルに自動的に埋め込んでくれるので、プログラムする必要がありません。</p>
</blockquote>
<p>　</p>
<p align="center">みなさんも、サンプルを参考にいろんなスクリーンセーバーを作成してくださいね。 </p>

</body>

</html>
