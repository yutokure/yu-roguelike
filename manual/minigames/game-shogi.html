<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ミニゲーム: 将棋</title>
    <link rel="stylesheet" href="../manual.css">
</head>
<body>
    <main>
        <h1>ミニゲーム: 将棋</h1>
        <section>
            <h2>概要</h2>
            <p>
                9×9 の将棋盤を使い、後手（あなた）と先手（CPU）が本格的な手合いを行うミニゲームです。
                駒の移動先や取れるマス、直前の指し手、王手を受けているマスが色分けされ、手番やメッセージも情報パネルで確認できます。
                成りや持ち駒の打ち込みといった将棋ならではの要素が揃っているので、初心者の練習から詰み筋の研究まで幅広く使えます。
            </p>
            <p>
                盤面下部では自分の持ち駒がチップ状に並び、クリックだけで打ち場所の候補がハイライト表示されます。
                操作のたびに経験値（EXP）が加算される仕組みもあり、捕獲や成り、王手、勝利で追加ボーナスを狙えます。
            </p>
        </section>
        <section>
            <h2>起動と難易度</h2>
            <ul>
                <li>ミニゲームセレクションの「ボード」カテゴリから <strong>将棋</strong> を選ぶと後手（下側）で対局が始まります。</li>
                <li>難易度は <strong>EASY</strong>／<strong>NORMAL</strong>／<strong>HARD</strong> の 3 段階です。指定がない場合は NORMAL で開始します。</li>
                <li>EASY はランダム寄りの指し手選択、NORMAL は評価関数付きの 1 手読み、HARD は 3 手読みのミニマックス探索で応戦します。</li>
                <li>ゲーム画面の見出し横に現在の難易度タグが表示され、いつでも確認できます。</li>
            </ul>
            <p class="small-note">API 経由で呼び出す場合は <code>options.difficulty</code> に <code>"EASY"</code>／<code>"NORMAL"</code>／<code>"HARD"</code> を渡してください。</p>
        </section>
        <section>
            <h2>画面構成</h2>
            <ul>
                <li><strong>情報パネル</strong>：タイトル、難易度、手番表示（あなたの番／CPU 思考中）、補足メッセージがまとまっています。</li>
                <li><strong>持ち駒ボード</strong>：上段は CPU の持ち駒、下段はあなたの持ち駒を表示します。枚数の合計も右上に表示されます。</li>
                <li><strong>将棋盤</strong>：木目調の 9×9 マス。選択中マス（黄金色）、移動可能マス（水色）、捕獲可能マス（薄赤）、直前の手（淡い青）、王手中の玉（濃赤）などが色で示されます。</li>
                <li><strong>レジェンド</strong>：手を指したときにもらえる EXP の一覧がコンパクトにまとまっています。</li>
                <li><strong>アクション行</strong>：リスタートボタンからいつでも初期局面へ戻せます。</li>
            </ul>
        </section>
        <section>
            <h2>操作方法</h2>
            <ul>
                <li>自陣の駒をクリックすると選択状態になり、合法手だけがハイライトされます。</li>
                <li>ハイライトされたマスをクリックすると移動します。赤いハイライトは駒取りが可能なマスです。</li>
                <li>持ち駒はチップをクリックして選択し、盤上のハイライトマスをクリックすると打ち込めます。再クリックで選択解除できます。</li>
                <li>成りが選択できる手は、着手先をクリックしたあとに確認ダイアログで成る／成らないを選択します。必須の場面では自動的に成ります。</li>
                <li>CPU の手番中はクリックしても動きません。メッセージ欄の「CPU が指し手を検討中…」が消えるまで待ちましょう。</li>
                <li>リスタートボタンで対局をリセットできます。勝敗がついたあとや研究をやり直したいときに便利です。</li>
            </ul>
        </section>
        <section>
            <h2>将棋の基本ルール</h2>
            <p>将棋は互いに 1 手ずつ指し、相手の玉将（王）を逃げられない状態に追い込むゲームです。盤の上段が先手陣、下段が後手陣になります。</p>
            <h3>駒の種類と動き</h3>
            <ul>
                <li><strong>玉（王）</strong>：縦横斜めの 8 方向に 1 マス動けます。王手がかかるマスへは進めません。</li>
                <li><strong>金将</strong>：前後左右と前斜め 2 マス（先手なら前側、後手なら下側）に進める守備の要です。</li>
                <li><strong>銀将</strong>：前斜め 2 マスと前 1 マス、後ろ斜め 2 マスに動けます。成ると金と同じ動きになります。</li>
                <li><strong>桂馬</strong>：前方向に「二マス進んで一マス斜め」のジャンプ移動をします。途中の駒を飛び越せます。成ると金と同じ動きです。</li>
                <li><strong>香車</strong>：前方向へ何マスでも進めます。成ると金と同じ動きになります。</li>
                <li><strong>歩兵</strong>：前へ 1 マス進み、正面の敵駒を取れます。成ると「と金」となり金と同じ動きです。</li>
                <li><strong>角行</strong>：斜め方向に何マスでも進みます。成ると斜めに加えて縦横 1 マスずつ動ける「馬」になります。</li>
                <li><strong>飛車</strong>：縦横に何マスでも進みます。成ると縦横に加えて斜め 1 マスを動ける「龍王」になります。</li>
            </ul>
            <h3>成り（昇格）</h3>
            <ul>
                <li>相手陣の 3 段目に入る、通過する、出る着手で成り／不成りを選べます（玉・金は成りません）。</li>
                <li>歩と香は敵陣最奥段、桂は最奥から 2 段目以内へ進むときに強制的に成ります。</li>
                <li>成った駒は駒字が変わり、移動範囲が金や馬・龍に変化します。</li>
            </ul>
            <h3>持ち駒の打ち込み</h3>
            <ul>
                <li>取った駒は自分の手番で空きマスに打てます。打った駒は裏返って未成りの状態で登場します。</li>
                <li>歩は同じ筋に未成りの歩がある場合は打てません（二歩の禁止）。</li>
                <li>歩と香は敵陣最奥段、桂は最奥から 2 段目以内のマスへは打てません（進めなくなるため）。</li>
                <li>本ミニゲームでは打ち歩詰めのチェックは実装していないため、例外的に詰みになる歩打ちも可能です。</li>
            </ul>
            <h3>王手と詰み</h3>
            <ul>
                <li>玉が攻撃されている状態が王手です。受け方（逃げる・取る・合駒する）のいずれかで必ず解消します。</li>
                <li>合法手がなく王手を受けているときは詰みとなり対局終了です。</li>
                <li>合法手がなく王手もかかっていない場合は持将棋／千日手扱いの引き分けとして処理されます。</li>
            </ul>
        </section>
        <section>
            <h2>EXP とスコア</h2>
            <p>あなたの指し手に応じて MiniExp 共通の経験値が加算され、内部スコアにも反映されます。</p>
            <ul>
                <li>通常の指し手・持ち駒の打ち込み：それぞれ <strong>+1 EXP</strong>。</li>
                <li>駒取り：駒種に応じて <strong>+8（歩）／+12（香）／+14（桂）／+16（銀）／+18（金）／+28（角）／+34（飛）／+200（玉）EXP</strong>。</li>
                <li>成り成功：<strong>+18 EXP</strong>。</li>
                <li>王手：<strong>+14 EXP</strong>。</li>
                <li>勝利ボーナス：難易度ごとに <strong>EASY 260／NORMAL 420／HARD 700 EXP</strong>。</li>
                <li>引き分け：<strong>+120 EXP</strong>。</li>
            </ul>
            <p class="small-note">画面右上のスコア表示は駒の価値や持ち駒数を加味した内部ポイントで、成績の目安になります。</p>
        </section>
        <section>
            <h2>勝敗と終局判定</h2>
            <ul>
                <li>CPU の玉を詰ませると勝利です。勝敗が決まると情報パネルに結果メッセージが表示され、操作が停止します。</li>
                <li>自玉が詰まされると敗北となり、EXP ボーナスは入りません。</li>
                <li>両者とも合法手がなく王手がかかっていない場合は持将棋／千日手扱いで引き分けになります。</li>
                <li>終局後はリスタートで初期配置に戻るか、ミニゲーム一覧へ戻って別タイトルを遊びましょう。</li>
            </ul>
        </section>
        <section>
            <h2>表示サポートとヒント</h2>
            <ul>
                <li>直前に動いた駒の出発・到着マスが淡い青で示されるため、手順を振り返りやすくなっています。</li>
                <li>合法手のみがハイライトされるので、初心者でも反則を恐れずに指せます。</li>
                <li>持ち駒のハイライトと盤面のホバー枠を活用すると、打ち筋や詰み手順を視覚的に確認できます。</li>
                <li>HARD は 3 手読みで駒得を優先してくるため、守りを固めつつ駒得を狙う指し方が効果的です。最初は EASY で操作に慣れ、段階的に難易度を上げると良いでしょう。</li>
            </ul>
        </section>
        <section>
            <h2>初心者向け戦略ガイド</h2>
            <h3>序盤のコツ</h3>
            <ul>
                <li>まずは自陣の金銀を玉の周りに配置し、美濃囲いや舟囲いのような堅い形を意識しましょう。</li>
                <li>歩を突いて角道や飛車の通り道を作り、駒を働かせる準備をします。</li>
                <li>同じ駒を何度も動かすより、複数の駒をバランスよく前線に送り出すことが大切です。</li>
            </ul>
            <h3>中盤の考え方</h3>
            <ul>
                <li>交換するときは取る駒と取られる駒の価値を比較し、有利なトレードだけを選びましょう。</li>
                <li>金銀で玉を囲いつつ、飛車・角・桂の利きを使って相手陣を圧迫します。</li>
                <li>持ち駒が増えたら、敵陣の弱点（玉頭や隙間）に打ち込んで攻め筋を作ります。</li>
            </ul>
            <h3>終盤のポイント</h3>
            <ul>
                <li>詰みを狙うときは王手の連続だけでなく、逃げ道を塞ぐ合駒や打ち歩の筋も視野に入れます。</li>
                <li>玉が危険になったら早めに逃げ道を作り、相手の王手を受けながら反撃する「入玉」や「凌ぎ」を意識しましょう。</li>
                <li>HARD では連続王手や成りで一気に決めるのが有効です。持ち駒を温存しておき、終盤にまとめて投下すると決め手になります。</li>
            </ul>
            <p class="small-note">これらの考え方は実際の将棋でも役立ちます。AI の指し手を参考にしながら、自分なりの定跡や詰め手順を研究してみましょう。</p>
        </section>
    </main>
</body>
</html>
