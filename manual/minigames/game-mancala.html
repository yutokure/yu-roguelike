<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ミニゲーム: マンカラ</title>
    <link rel="stylesheet" href="../manual.css">
</head>
<body>
    <main>
        <h1>ミニゲーム: マンカラ</h1>
        <section>
            <h2>概要</h2>
            <p>
                6 個の穴に並んだ石を時計回りに蒔き、相手より多くの石を自分のストア（陣地端の大きな穴）に集めるボードゲームです。
                MiniExp 版はカラハ（Kalah）式を採用しており、AI と 1 対 1 で対戦します。難易度設定に応じて初期の石の数と AI の思考
                速度、獲得経験値 (EXP) の倍率が変化します。
                マンカラを初めて遊ぶ人でもクリック操作とターン進行のチュートリアルのみで遊び始められるよう、ヒントボタンや手
                番ステータスが常時表示されます。
            </p>
        </section>
        <section>
            <h2>画面構成</h2>
            <ul>
                <li><strong>ステータスバー</strong>：画面上部のバッジで現在の手番や勝敗結果を表示します。隣には自分と AI のストアに貯まった石数がリアルタイムで更新されます。</li>
                <li><strong>操作ボタン</strong>：<q>リスタート</q> で盤面を初期化、<q>ヒント</q> でおすすめの穴を一時的にハイライトします。キーボードの <kbd>R</kbd> でもリスタート可能です。</li>
                <li><strong>ボード</strong>：中央に 6×2 の穴と左右のストアを配置。下段がプレイヤーの穴 1〜6、上段が AI の穴 6〜1 です。各穴の石数はボタン中央に表示され、下部の小さなラベルで番号と陣営を確認できます。</li>
                <li><strong>行動ログ</strong>：画面下部のログが直近 12 手を記録します。選択した穴番号、ストアへ入った石数、捕獲数、追加ターンの有無などを振り返れます。</li>
            </ul>
        </section>
        <section>
            <h2>ゲームの流れ</h2>
            <ol>
                <li>自分の番になったら、下段の穴のうち石が入っているものをクリックします。クリックするとその穴の石をすべて取り出します。</li>
                <li>取り出した石を、現在位置の次の穴から 1 個ずつ時計回りに蒔いていきます。自分のストアには石を入れますが、相手のストアは飛ばして進みます。</li>
                <li>最後の石を置いた位置が自分のストアなら追加ターンを獲得します。別の穴を選んで続けて手番を行いましょう。</li>
                <li>最後の石が自分側の空の穴に落ち、向かい側の相手の穴に石が残っている場合は、両方の石を自分のストアへ捕獲します。</li>
                <li>どちらか一方の陣営の穴がすべて空になったらゲーム終了です。残っている石は相手ストアにまとめて入れられ、最終的にストアの石が多い方が勝利となります。</li>
            </ol>
        </section>
        <section>
            <h2>ルール詳細</h2>
            <ul>
                <li><strong>初期配置</strong>：難易度イージーは 1 穴あたり 3 個、ノーマルは 4 個、ハードは 5 個の石から開始します。</li>
                <li><strong>合法手</strong>：手番中に選べるのは自分側の石が 1 個以上入った穴のみです。選択できる穴は淡いハイライトとホバーアニメーションで示されます。</li>
                <li><strong>追加ターン</strong>：最後の石を自分のストアに入れた場合に発生します。ステータスバーにも「追加ターン」が表示され、ボタンのハイライトが持続します。</li>
                <li><strong>捕獲</strong>：自分側の空の穴で手番を終え、向かい側に石があれば両方の石を自分のストアへ移します。捕獲が起きると対象の穴が点滅します。</li>
                <li><strong>終局処理</strong>：どちらかの列が空になった瞬間、残っている相手側の石はそのまま相手のストアに入ります。引き分けも存在し、ストアの石数が同じ場合は結果表示で通知されます。</li>
                <li><strong>AI 思考</strong>：ノーマル・ハードでは手番の候補手をシミュレーションして評価し、ハードはプレイヤーの反撃余地も軽減する手を選びます。考慮時間は難易度ごとに 900 / 650 / 450 ミリ秒が目安です。</li>
            </ul>
        </section>
        <section>
            <h2>獲得 EXP とスコア</h2>
            <ul>
                <li>1 ターンの基本 EXP：<strong>+1</strong> に加えて、ストアへ入れた石 ×0.6、捕獲した石 ×1.5、追加ターン発生時は +2.5 を加算し、難易度倍率（イージー 0.8 / ノーマル 1.0 / ハード 1.2）をかけて端数を四捨五入します。</li>
                <li>勝利ボーナス：<strong>22 + min(40, 勝利差 ×2.5)</strong> に難易度倍率を適用して付与されます。僅差でも確実に勝つことが EXP を稼ぐ近道です。</li>
                <li>スコア表示：ステータスバー右側のバッジが自分と AI のストア石数を表し、MiniExp のスコアとしても自分のストア石数が採用されます。</li>
            </ul>
        </section>
        <section>
            <h2>戦略とヒント</h2>
            <ul>
                <li>序盤は追加ターンが狙える穴（通常は自陣の右寄り）を意識して選ぶとペースを握れます。ヒントボタンも追加ターンが見込める手を優先的に提示します。</li>
                <li>捕獲を狙う際は、相手に同じチャンスを渡さないよう背後の石配置を確認しましょう。相手の列に大きな塊が残っている時は、終盤の一掃に備えて石を貯めすぎないことが大切です。</li>
                <li>ハードでは AI がこちらの捕獲を封じる手を優先するため、空の穴を作りすぎると好機を逃します。常に複数の穴に 2〜3 個の石を散らしておくと柔軟に対応できます。</li>
            </ul>
        </section>
    </main>
</body>
</html>
